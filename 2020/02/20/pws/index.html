<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">


  <script>(function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/a656b92c.js","daovoice")
  daovoice('init', {
  	app_id: "a656b92c"
  });
daovoice('update');
  </script>


<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('https://KKotori.github.io').hostname,
    root: '/',
    scheme: 'Muse',
    version: '7.7.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":true},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta name="description" content="密码学的实验报告，密码学真的难，DES完全是只知道思路但是写不出代码，最后到github参考了别人的代码才勉强修改完成，哈希稍微好些，可以选择，选了SHA-256以后简单的做了一个不加盐的函数，但是仍旧不是自己完全写出来的成果，ORZ…过程很辛苦，查了很多资料，看了很多别人的实现方法，还是记录一下。">
<meta property="og:type" content="article">
<meta property="og:title" content="密码学实验">
<meta property="og:url" content="https://kkotori.github.io/2020/02/20/pws/index.html">
<meta property="og:site_name" content="WS">
<meta property="og:description" content="密码学的实验报告，密码学真的难，DES完全是只知道思路但是写不出代码，最后到github参考了别人的代码才勉强修改完成，哈希稍微好些，可以选择，选了SHA-256以后简单的做了一个不加盐的函数，但是仍旧不是自己完全写出来的成果，ORZ…过程很辛苦，查了很多资料，看了很多别人的实现方法，还是记录一下。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://kkotori.github.io/2020/02/20/pws/image001.jpg">
<meta property="og:image" content="https://kkotori.github.io/2020/02/20/pws/image002.jpg">
<meta property="og:image" content="https://kkotori.github.io/2020/02/20/pws/image003.jpg">
<meta property="og:image" content="https://kkotori.github.io/2020/02/20/pws/image004.jpg">
<meta property="og:image" content="https://kkotori.github.io/2020/02/20/pws/image005.jpg">
<meta property="og:image" content="https://kkotori.github.io/2020/02/20/pws/image006.jpg">
<meta property="og:image" content="https://kkotori.github.io/2020/02/20/pws/image007.jpg">
<meta property="og:image" content="https://kkotori.github.io/2020/02/20/pws/image008.jpg">
<meta property="og:image" content="https://kkotori.github.io/2020/02/20/pws/image009.jpg">
<meta property="og:image" content="https://kkotori.github.io/2020/02/20/pws/image010.jpg">
<meta property="og:image" content="https://kkotori.github.io/2020/02/20/pws/image011.jpg">
<meta property="og:image" content="https://kkotori.github.io/2020/02/20/pws/image012.jpg">
<meta property="og:image" content="https://kkotori.github.io/2020/02/20/pws/image013.jpg">
<meta property="og:image" content="https://kkotori.github.io/2020/02/20/pws/image014.jpg">
<meta property="og:image" content="https://kkotori.github.io/2020/02/20/pws/image015.jpg">
<meta property="og:image" content="https://kkotori.github.io/2020/02/20/pws/image016.jpg">
<meta property="og:image" content="https://kkotori.github.io/2020/02/20/pws/image017.jpg">
<meta property="og:image" content="https://kkotori.github.io/2020/02/20/pws/image019.jpg">
<meta property="og:image" content="https://kkotori.github.io/2020/02/20/pws/image020.jpg">
<meta property="og:image" content="https://kkotori.github.io/2020/02/20/pws/image021.jpg">
<meta property="og:image" content="https://kkotori.github.io/2020/02/20/pws/image022.jpg">
<meta property="og:image" content="https://kkotori.github.io/2020/02/20/pws/image023.jpg">
<meta property="article:published_time" content="2020-02-20T07:36:40.000Z">
<meta property="article:modified_time" content="2020-02-21T11:24:45.374Z">
<meta property="article:author" content="K_Kotori">
<meta property="article:tag" content="StudyM">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://kkotori.github.io/2020/02/20/pws/image001.jpg">

<link rel="canonical" href="https://kkotori.github.io/2020/02/20/pws/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>

  <title>密码学实验 | WS</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">WS</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://kkotori.github.io/2020/02/20/pws/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="K_Kotori">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="WS">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          密码学实验
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-02-20 15:36:40" itemprop="dateCreated datePublished" datetime="2020-02-20T15:36:40+08:00">2020-02-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-02-21 19:24:45" itemprop="dateModified" datetime="2020-02-21T19:24:45+08:00">2020-02-21</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/StudyM/" itemprop="url" rel="index">
                    <span itemprop="name">StudyM</span>
                  </a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
    {font-family:"MS Mincho";
    panose-1:2 2 6 9 4 2 5 8 3 4;}
@font-face
    {font-family:宋体;
    panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
    {font-family:黑体;
    panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
    {font-family:"Cambria Math";
    panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
    {font-family:等线;
    panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
    {font-family:"等线 Light";
    panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
    {font-family:华文中宋;
    panose-1:2 1 6 0 4 1 1 1 1 1;}
@font-face
    {font-family:Tahoma;
    panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
    {font-family:Cambria;
    panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
    {font-family:Consolas;
    panose-1:2 11 6 9 2 2 4 3 2 4;}
@font-face
    {font-family:"\@等线";
    panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
    {font-family:"\@华文中宋";}
@font-face
    {font-family:"\@黑体";
    panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
    {font-family:"\@等线 Light";}
@font-face
    {font-family:"\@宋体";
    panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
    {font-family:"\@MS Mincho";
    panose-1:2 2 6 9 4 2 5 8 3 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
    {margin:0cm;
    margin-bottom:.0001pt;
    text-align:justify;
    text-justify:inter-ideograph;
    font-size:10.5pt;
    font-family:等线;}
h1
    {mso-style-link:"标题 1 字符";
    margin-top:17.0pt;
    margin-right:0cm;
    margin-bottom:16.5pt;
    margin-left:0cm;
    text-align:justify;
    text-justify:inter-ideograph;
    line-height:240%;
    page-break-after:avoid;
    font-size:22.0pt;
    font-family:等线;
    font-weight:bold;}
h3
    {mso-style-link:"标题 3 字符";
    margin-top:13.0pt;
    margin-right:0cm;
    margin-bottom:13.0pt;
    margin-left:0cm;
    text-align:justify;
    text-justify:inter-ideograph;
    line-height:173%;
    page-break-after:avoid;
    font-size:16.0pt;
    font-family:等线;
    font-weight:bold;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
    {margin:0cm;
    margin-bottom:.0001pt;
    text-align:justify;
    text-justify:inter-ideograph;
    font-size:10.5pt;
    font-family:等线;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
    {margin-top:0cm;
    margin-right:0cm;
    margin-bottom:0cm;
    margin-left:21.0pt;
    margin-bottom:.0001pt;
    text-align:justify;
    text-justify:inter-ideograph;
    font-size:10.5pt;
    font-family:等线;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
    {margin-top:0cm;
    margin-right:0cm;
    margin-bottom:0cm;
    margin-left:42.0pt;
    margin-bottom:.0001pt;
    text-align:justify;
    text-justify:inter-ideograph;
    font-size:10.5pt;
    font-family:等线;
    font-weight:bold;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
    {mso-style-link:"页眉 字符";
    margin:0cm;
    margin-bottom:.0001pt;
    text-align:center;
    layout-grid-mode:char;
    border:none;
    padding:0cm;
    font-size:9.0pt;
    font-family:等线;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
    {mso-style-link:"页脚 字符";
    margin:0cm;
    margin-bottom:.0001pt;
    layout-grid-mode:char;
    font-size:9.0pt;
    font-family:等线;}
a:link, span.MsoHyperlink
    {color:blue;
    text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
    {color:#954F72;
    text-decoration:underline;}
p
    {margin-right:0cm;
    margin-left:0cm;
    font-size:12.0pt;
    font-family:宋体;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
    {margin:0cm;
    margin-bottom:.0001pt;
    text-align:justify;
    text-justify:inter-ideograph;
    text-indent:21.0pt;
    font-size:10.5pt;
    font-family:等线;}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
    {margin-top:12.0pt;
    margin-right:0cm;
    margin-bottom:0cm;
    margin-left:0cm;
    margin-bottom:.0001pt;
    line-height:107%;
    page-break-after:avoid;
    font-size:16.0pt;
    font-family:"等线 Light";
    color:#2F5496;}
span.a
    {mso-style-name:"页眉 字符";
    mso-style-link:页眉;}
span.a0
    {mso-style-name:"页脚 字符";
    mso-style-link:页脚;}
span.1
    {mso-style-name:"标题 1 字符";
    mso-style-link:"标题 1";
    font-weight:bold;}
span.3
    {mso-style-name:"标题 3 字符";
    mso-style-link:"标题 3";
    font-weight:bold;}
.MsoChpDefault
    {font-family:等线;}
 /* Page Definitions */
 @page WordSection1
    {size:595.3pt 841.9pt;
    margin:72.0pt 90.0pt 72.0pt 90.0pt;
    layout-grid:15.6pt;}
div.WordSection1
    {page:WordSection1;}
 /* List Definitions */
 ol
    {margin-bottom:0cm;}
ul
    {margin-bottom:0cm;}
-->
</style>

</head>

<body lang=ZH-CN link=blue vlink="#954F72" style='text-justify-trim:punctuation'>

<p>密码学的实验报告，密码学真的难，DES完全是只知道思路但是写不出代码，最后到github参考了别人的代码才勉强修改完成，哈希稍微好些，可以选择，选了SHA-256以后简单的做了一个不加盐的函数，但是仍旧不是自己完全写出来的成果，ORZ…<br>过程很辛苦，查了很多资料，看了很多别人的实现方法，还是记录一下。</p>
<a id="more"></a>
<h1 id="古典密码"><a href="#古典密码" class="headerlink" title="古典密码"></a><a name="_Toc28387027"><span style='font-size:18.0pt;font-family:黑体'>古典密码</span></a></h1><h2 id="凯撒密码"><a href="#凯撒密码" class="headerlink" title="凯撒密码"></a><a name="_Toc534469237"><span style='font-size:16.0pt;font-family:黑体'>凯撒密码</span></a></h2><p><span style='color:black'>在<span lang=EN-US><a href="https://baike.baidu.com/item/%E5%AF%86%E7%A0%81%E5%AD%A6" target="_blank" rel="noopener"><span lang=EN-US style='color:black;text-decoration:none'><span lang=EN-US>密码学</span></span></a></span>中，恺撒密码（英语：<span lang=EN-US>Caesar cipher</span>），或称恺撒加密、恺撒变换、变换加密，是一种最简单且最广为人知的加密技术。它是一种替换加密的技术，</span><span lang=EN-US><a href="https://baike.baidu.com/item/%E6%98%8E%E6%96%87" target="_blank" rel="noopener"><span lang=EN-US style='color:black;text-decoration:none'><span lang=EN-US>明文</span></span></a></span><span style='color:black'>中的所有字母都在</span><span lang=EN-US><a href="https://baike.baidu.com/item/%E5%AD%97%E6%AF%8D%E8%A1%A8" target="_blank" rel="noopener"><span lang=EN-US style='color:black;text-decoration:none'><span lang=EN-US>字母表</span></span></a></span><span style='color:black'>上向后（或向前）按照一个固定数目进行偏移后被替换成<span lang=EN-US><a href="https://baike.baidu.com/item/%E5%AF%86%E6%96%87" target="_blank" rel="noopener"><span lang=EN-US style='color:black;text-decoration:none'><span lang=EN-US>密文</span></span></a></span>。例如，当偏移量是<span lang=EN-US>3</span>的时候，所有的字母<span lang=EN-US>A</span>将被替换成<span lang=EN-US>D</span>，<span lang=EN-US>B</span>变成<span lang=EN-US>E</span>，以此类推。这个加密方法是以罗马共和时期</span><span lang=EN-US><a href="https://baike.baidu.com/item/%E6%81%BA%E6%92%92" target="_blank" rel="noopener"><span lang=EN-US style='color:black;text-decoration:none'><span lang=EN-US>恺撒</span></span></a></span><span style='color:black'>的名字命名的，当年恺撒曾用此方法与其将军们进行联系。</span></p>
<h3 id="凯撒安全性分析"><a href="#凯撒安全性分析" class="headerlink" title="凯撒安全性分析"></a><span style='font-size:14.0pt;font-family:黑体'>凯撒安全性分析</span></h3><p>由于英文只有<span lang=EN-US>26</span>个字母，而且可以通过求余降幂，规模最大为<span lang=EN-US>26</span>。完全可以暴力攻击。</p>
<h3 id="加密"><a href="#加密" class="headerlink" title="加密"></a><span style='font-size:14.0pt'>加密</span></h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">char</span> cry[<span class="number">1000010</span>];</span><br><span class="line"><span class="comment">//char enc[1000010];</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> t,k;</span><br><span class="line">  <span class="keyword">int</span> i;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line">  <span class="keyword">while</span>(t–)&#123;</span><br><span class="line">     <span class="built_in">memset</span>(cry,<span class="string">'\0'</span>,<span class="keyword">sizeof</span>(cry));</span><br><span class="line">     <span class="comment">//memset(enc,'\0',sizeof(enc));</span></span><br><span class="line">     <span class="built_in">scanf</span>(<span class="string">"%s"</span>,cry);</span><br><span class="line">     <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;k);</span><br><span class="line">     <span class="comment">//printf("%d",k);</span></span><br><span class="line">     <span class="comment">//for(i=0;cry[i]!='\0';i++);</span></span><br><span class="line">     k=k%<span class="number">26</span>;</span><br><span class="line">     <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;cry[i]!=<span class="string">'\0'</span>;i++)&#123;</span><br><span class="line">         <span class="keyword">if</span>(cry[i]&lt;<span class="string">'A'</span>||cry[i]&gt;<span class="string">'z'</span>||(cry[i]&gt;<span class="string">'Z'</span>&amp;&amp;cry[i]&lt;<span class="string">'a'</span>))&#123;</span><br><span class="line">            cry[i]=cry[i];</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">else</span></span><br><span class="line">         <span class="keyword">if</span>((cry[i]-k&gt;<span class="string">'Z'</span>&amp;&amp;(cry[i]&gt;=<span class="string">'A'</span>&amp;&amp;cry[i]&lt;=<span class="string">'Z'</span>))||(cry[i]-k&gt;<span class="string">'z'</span>&amp;&amp;(cry[i]&gt;=<span class="string">'a'</span>&amp;&amp;cry[i]&lt;=<span class="string">'z'</span>)))&#123;</span><br><span class="line">            cry[i]=<span class="keyword">char</span>(cry[i]+k<span class="number">-26</span>);</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">else</span></span><br><span class="line">         <span class="keyword">if</span>((cry[i]-k&lt;<span class="string">'A'</span>&amp;&amp;(cry[i]&gt;=<span class="string">'A'</span>&amp;&amp;cry[i]&lt;=<span class="string">'Z'</span>))||(cry[i]-k&lt;<span class="string">'a'</span>&amp;&amp;(cry[i]&gt;=<span class="string">'a'</span>&amp;&amp;cry[i]&lt;=<span class="string">'z'</span>)))&#123;</span><br><span class="line">            cry[i]=<span class="keyword">char</span>(cry[i]+<span class="number">26</span>-k);</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">else</span>&#123;</span><br><span class="line">            cry[i]=<span class="keyword">char</span>(cry[i]-k);</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="built_in">printf</span>(<span class="string">"%s\n"</span>,cry);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//cout&lt;&lt;cry;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="破解"><a href="#破解" class="headerlink" title="破解"></a><span style='font-size:14.0pt'>破解</span></h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="comment">//unknow K7</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">char</span> cip[<span class="number">1000010</span>];</span><br><span class="line"><span class="keyword">char</span> tr[<span class="number">1000010</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="built_in">memset</span>(cip,<span class="string">'\0'</span>,<span class="keyword">sizeof</span>(cip));</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%s"</span>,cip);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">25</span>;k&gt;=<span class="number">0</span>;k–)&#123;</span><br><span class="line">     <span class="built_in">printf</span>(<span class="string">"key=%d\n"</span>,<span class="number">26</span>-k);</span><br><span class="line">     <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;cip[i]!=<span class="string">'\0'</span>;i++)&#123;</span><br><span class="line">         if(cip[i]&lt;'A'||cip[i]&gt;'z'||(cip[i]&gt;'Z&amp;&amp;cip[i]&lt;'a'))&#123;'</span><br><span class="line">            tr[i]=cip[i];</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">else</span></span><br><span class="line">         <span class="keyword">if</span>((cip[i]-k&gt;<span class="string">'Z'</span>&amp;&amp;(cip[i]&gt;=<span class="string">'A'</span>&amp;&amp;cip[i]&lt;=<span class="string">'Z'</span>))||(cip[i]-k&gt;<span class="string">'z'</span>&amp;&amp;(cip[i]&gt;=<span class="string">'a'</span>&amp;&amp;cip[i]&lt;=<span class="string">'z'</span>)))&#123;</span><br><span class="line">            tr[i]=<span class="keyword">char</span>(cip[i]+k<span class="number">-26</span>);</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">else</span></span><br><span class="line">         <span class="keyword">if</span>((cip[i]-k&lt;<span class="string">'A'</span>&amp;&amp;(cip[i]&gt;=<span class="string">'A'</span>&amp;&amp;cip[i]&lt;=<span class="string">'Z'</span>))||(cip[i]-k&lt;<span class="string">'a'</span>&amp;&amp;(cip[i]&gt;=<span class="string">'a'</span>&amp;&amp;cip[i]&lt;=<span class="string">'z'</span>)))&#123;</span><br><span class="line">            tr[i]=<span class="keyword">char</span>(cip[i]+<span class="number">26</span>-k);</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">else</span>&#123;</span><br><span class="line">            tr[i]=<span class="keyword">char</span>(cip[i]-k);</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="built_in">printf</span>(<span class="string">"%s\n"</span>,tr);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="程序运行截图"><a href="#程序运行截图" class="headerlink" title="程序运行截图"></a><span style='font-size:14.0pt;font-family:黑体'>程序运行截图</span></h3><p><span lang=EN-US><img src="/2020/02/20/pws/image001.jpg" class=""></span></p>
<p><span lang=EN-US><img src="/2020/02/20/pws/image002.jpg" class=""></span></p>
<span lang=EN-US style='font-size:12.0pt;font-family:等线'>

</span>

<h2 id="维吉尼亚密码"><a href="#维吉尼亚密码" class="headerlink" title="维吉尼亚密码"></a><a name="_Toc534469238"><span style='font-size:16.0pt;font-family:黑体'>维吉尼亚密码</span></a></h2><p><span style='font-family:宋体;color:black'>维吉尼亚密码（又译维热纳尔密码）是使用一系列<span lang=EN-US><a href="https://baike.baidu.com/item/%E5%87%AF%E6%92%92%E5%AF%86%E7%A0%81" target="_blank" rel="noopener">凯撒密码</a></span>组成密码字母表的加密算法，属于多表密码的一种简单形式。</span><br><span style='font-family:宋体;color:black'>维吉尼亚密码曾多次被发明。该方法最早记录在<span lang=EN-US><a href="https://baike.baidu.com/item/%E5%90%89%E5%A5%A5%E4%B8%87%C2%B7%E5%B7%B4%E8%92%82%E6%96%AF%E5%A1%94%C2%B7%E8%B4%9D%E6%8B%89%E7%B4%A2" target="_blank" rel="noopener">吉奥万·巴蒂斯塔·贝拉索</a></span>（<span lang=EN-US> Giovan Battista Bellaso</span>）于<span lang=EN-US>1553</span>年所著的书《吉奥万<span lang=EN-US>·</span>巴蒂斯塔<span lang=EN-US>·</span>贝拉索先生的密码》（<span lang=EN-US>意大利语</span>：<span lang=EN-US>La cifra del. Sig.Giovan Battista Bellaso</span>）中。然而，后来在<span lang=EN-US>19</span>世纪时被误传为是<span lang=EN-US>法国</span>外交官</span><span lang=EN-US><a href="https://baike.baidu.com/item/%E5%B8%83%E8%8E%B1%E6%96%AF%C2%B7%E5%BE%B7%C2%B7%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A" target="_blank" rel="noopener">布莱斯·德·维吉尼亚</a></span><span style='font-family:宋体;color:black'>（<span lang=EN-US>Blaise De Vigenère</span>）所创造，因此现在被称为<span lang=EN-US>“</span>维吉尼亚密码<span lang=EN-US>”</span>。</span></p>
<h3 id="仿射密码的安全性分析"><a href="#仿射密码的安全性分析" class="headerlink" title="仿射密码的安全性分析"></a><span style='font-size:14.0pt;font-family:黑体'>仿射密码的安全性分析</span></h3><p><span style='font-family:宋体;color:black'>弗里德曼试验由威廉<span lang=EN-US>·F·</span>弗里德曼（<span lang=EN-US>William F. Friedman</span>）于<span lang=EN-US>1920</span>年代发明。他使用了<span lang=EN-US><a href="https://baike.baidu.com/item/%E9%87%8D%E5%90%88%E6%8C%87%E6%95%B0" target="_blank" rel="noopener">重合指数</a></span>（<span lang=EN-US>index of coincidence</span>）来描述密文字母频率的不匀性，从而破译密码。</span></p>
<p><span lang=EN-US style='font-family:宋体;color:black'><img src="/2020/02/20/pws/image003.jpg" class=""></span></p>
<p><span style='font-family:宋体;color:black'>指目标语言中两个任意字母相同的概率（英文中为<span lang=EN-US>0.067</span>），</span></p>
<p><span lang=EN-US style='font-family:宋体;color:black'><img src="/2020/02/20/pws/image004.jpg" class=""></span></p>
<p><span style='font-family:宋体;color:black'>指字母表中这种情况出现的概率（英文中为<span lang=EN-US>1/26=0.0385</span>），从而密钥长度可以估计为：</span></p>
<p><span lang=EN-US style='font-family:宋体;color:black'><img src="/2020/02/20/pws/image005.jpg" class=""></span></p>
<p><span style='font-family:宋体;color:black'>其中，观察概率为</span></p>
<p><span lang=EN-US style='font-family:宋体;color:black'><img src="/2020/02/20/pws/image006.jpg" class=""></span></p>
<p><span style='font-family:宋体;color:black'>其中，<span lang=EN-US>c</span>是指字母表的长度（英文为<span lang=EN-US>26</span>），<span lang=EN-US>N</span>指文本的长度，<span lang=EN-US>n1</span>到<span lang=EN-US>n</span>是指密文的字母频率，为整数。</span><br><span style='font-family:宋体;color:black'>此方法只是一种估计，会随着文本长度的增加而更为精确。在实践中，会尝试接近此估计的多个密钥长度。一种更好的方法是将密文写成矩阵形式，其中列数与假定的密钥长度一致，将每一列的重合指数单独计算，并求得平均重合指数。对于所有可能的密钥长度，平均重合指数最高的最有可能是真正的密钥长度。这样的试验可以作为卡西斯基试验的补充。 </span></p>
<h3 id="频率分析"><a href="#频率分析" class="headerlink" title="频率分析"></a><span style='font-size:14.0pt;font-family:黑体'>频率分析</span></h3><p><span style='font-family:宋体;color:black'>一旦能够确定密钥的长度，密文就能重新写成多列，列数与密钥长度对应。这样每一列其实就是一个</span><span lang=EN-US>凯撒密码</span><span style='font-family:宋体;color:black'>，而此密码的密钥（偏移量）则对应于维吉尼亚密码密钥的相应字母。与破译凯撒密码类似的方法，就能将密文破译。</span><br><span style='font-family:宋体;color:black'>柯克霍夫方法作为卡西斯基试验的改进，由奥古斯特<span lang=EN-US>·</span>柯克霍夫（<span lang=EN-US>Auguste Kerckhoffs</span>）提出。它将每一列的字母频率与转换后的明文频率相对应而得出每一列的密钥字母。一旦密钥中每一个字母都能确定，就能很简单地破译密文，从而得到明文。如果维吉尼亚字母表表格本身是杂乱而非按通常字母表顺序的话，那柯克霍夫方法就会无效，但卡西斯基试验和重复指数对于决定密钥长度仍旧是有效的。</span></p>
<h3 id="加密-1"><a href="#加密-1" class="headerlink" title="加密"></a><span style='font-size:14.0pt'>加密</span></h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">char</span> k[<span class="number">105</span>];</span><br><span class="line"><span class="keyword">char</span> cyp[<span class="number">1010</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">         <span class="comment">//scanf("%s",&amp;k);</span></span><br><span class="line">         <span class="comment">//getline(cin,1010);</span></span><br><span class="line">         <span class="built_in">scanf</span>(<span class="string">"%s%[^\n]"</span>,&amp;k,&amp;cyp);</span><br><span class="line">         <span class="keyword">int</span> clen,klen;</span><br><span class="line">         <span class="comment">/**for(clen=0;cyp[clen]!=’\0’;clen++)&#123;</span></span><br><span class="line"><span class="comment">           if(cyp[clen]&gt;’Z’)&#123;</span></span><br><span class="line"><span class="comment">              cyp[clen]=char(cyp[clen]-(‘a’-‘A’));</span></span><br><span class="line"><span class="comment">           &#125;</span></span><br><span class="line"><span class="comment">         &#125;**/</span></span><br><span class="line">         <span class="keyword">for</span>(klen=<span class="number">0</span>;k[klen]!=’\<span class="number">0</span>’;klen++)&#123;</span><br><span class="line">           <span class="keyword">if</span>(k[klen]&gt;’Z’)&#123;</span><br><span class="line">              k[klen]=<span class="keyword">char</span>(k[klen]-(‘a’-‘A’));</span><br><span class="line">           &#125;</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="comment">//printf("%s",k);</span></span><br><span class="line">         <span class="keyword">int</span> j=<span class="number">0</span>;</span><br><span class="line">         <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;cyp[i]!=’\<span class="number">0</span>’;i++)&#123;</span><br><span class="line">           <span class="keyword">if</span>(cyp[i]&gt;=’A’&amp;&amp;cyp[i]&lt;=’Z’)&#123;</span><br><span class="line">              <span class="keyword">if</span>(cyp[i]+(k[j%klen]-‘A’)&gt;’Z’)&#123;</span><br><span class="line">                  cyp[i]=<span class="keyword">char</span>(cyp[i]-(<span class="number">26</span>-(k[j%klen]-‘A’)));</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">else</span>&#123;</span><br><span class="line">                  cyp[i]=<span class="keyword">char</span>(cyp[i]+(k[j%klen]-‘A’));</span><br><span class="line">              &#125;</span><br><span class="line">              j++;</span><br><span class="line">           &#125;</span><br><span class="line">           else if(cyp[i]==’ ‘||cyp[i]==’.’||cyp[i]==’,’||cyp[i]==’'‘)&#123;</span><br><span class="line">              <span class="comment">//cyp[i]=’‘;</span></span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">else</span>&#123;</span><br><span class="line">              <span class="keyword">if</span>(cyp[i]+(k[j%klen]-‘A’)&gt;’z’)&#123;</span><br><span class="line">                  cyp[i]=<span class="keyword">char</span>(cyp[i]-(<span class="number">26</span>-(k[j%klen]-‘A’)));</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">else</span>&#123;</span><br><span class="line">                  cyp[i]=<span class="keyword">char</span>(cyp[i]+(k[j%klen]-‘A’));</span><br><span class="line">              &#125;</span><br><span class="line">              j++;</span><br><span class="line">           &#125;</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="built_in">printf</span>(<span class="string">"%s\n"</span>,cyp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="破解-1"><a href="#破解-1" class="headerlink" title="破解"></a><span style='font-size:14.0pt'>破解</span></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_lowercase <span class="keyword">as</span> lowercase</span><br><span class="line"></span><br><span class="line"><span class="comment">#需要大量的明文支撑</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">VigenereDecrypto</span><span class="params">(output, key)</span>:</span></span><br><span class="line">    ptLen = len(output)</span><br><span class="line">    keyLen = len(key)</span><br><span class="line">    quotient = ptLen // keyLen</span><br><span class="line">    remainder = ptLen % keyLen</span><br><span class="line">    inp = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, quotient):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>, keyLen):</span><br><span class="line">            c = int((ord(output[i * keyLen + j]) - ord(<span class="string">'a'</span>) - (ord(key[j]) - ord(<span class="string">'a'</span>))) % <span class="number">26</span> + ord(<span class="string">'a'</span>))</span><br><span class="line">            inp += chr(c)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, remainder):</span><br><span class="line">        c = int((ord(output[quotient * keyLen + i]) - ord(<span class="string">'a'</span>) - (ord(key[i]) - ord(<span class="string">'a'</span>))) % <span class="number">26</span> + ord(<span class="string">'a'</span>))</span><br><span class="line">        <span class="comment"># global input</span></span><br><span class="line">        inp += chr(c)</span><br><span class="line">    <span class="keyword">return</span> inp</span><br><span class="line"><span class="comment">#纯文本</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_trim_text</span><span class="params">(text)</span>:</span></span><br><span class="line">    text = text.lower()</span><br><span class="line">    trim_text = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> text:</span><br><span class="line">        <span class="keyword">if</span> lowercase.find(l) &gt;= <span class="number">0</span>:</span><br><span class="line">            trim_text += l</span><br><span class="line">    <span class="keyword">return</span> trim_text</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算IC</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_coincidence_index</span><span class="params">(text)</span>:</span></span><br><span class="line">    text = get_trim_text(text)</span><br><span class="line">    length = len(text)</span><br><span class="line">    letter_stats = []</span><br><span class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> lowercase:</span><br><span class="line">        lt = &#123;&#125;</span><br><span class="line">        count = text.count(l)<span class="comment">#统计</span></span><br><span class="line">        lt[l] = count</span><br><span class="line">        letter_stats.append(lt)</span><br><span class="line"></span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> d <span class="keyword">in</span> letter_stats:</span><br><span class="line">        v = list(d.values())[<span class="number">0</span>]</span><br><span class="line">        index += (float(v) / length) ** <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> index</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 与0.67比较</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_var</span><span class="params">(data, mean=<span class="number">0.065</span>)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    var_sum = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> d <span class="keyword">in</span> data:</span><br><span class="line">        var_sum += (d - mean) ** <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> float(var_sum) / len(data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 爆破密钥长度</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_key_length</span><span class="params">(text)</span>:</span></span><br><span class="line">    <span class="comment"># assume text length less than 26</span></span><br><span class="line">    text = get_trim_text(text)</span><br><span class="line">    group = []</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> range(<span class="number">1</span>, len(text) + <span class="number">1</span>):</span><br><span class="line">        group_str = [<span class="string">''</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(n)]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(text)):</span><br><span class="line">            l = text[i]</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(n):</span><br><span class="line">                <span class="keyword">if</span> i % n == j:</span><br><span class="line">                    group_str[j] += l</span><br><span class="line">        group.append(group_str)</span><br><span class="line">    var_list = []</span><br><span class="line">    length = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> tex <span class="keyword">in</span> group:</span><br><span class="line">        data = []</span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> tex:</span><br><span class="line">            index = get_coincidence_index(t)</span><br><span class="line">            data.append(index)</span><br><span class="line">        var_list.append([length, get_var(data)])</span><br><span class="line">        length += <span class="number">1</span></span><br><span class="line">    var_list = sorted(var_list, key=<span class="keyword">lambda</span> x: x[<span class="number">1</span>])<span class="comment">#</span></span><br><span class="line">    <span class="keyword">return</span> [v[<span class="number">0</span>] <span class="keyword">for</span> v <span class="keyword">in</span> var_list[:int(n / <span class="number">2</span>) + <span class="number">1</span>]]  <span class="comment">#</span></span><br><span class="line"><span class="comment"># 统计字频，分组</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">countList</span><span class="params">(lis)</span>:</span></span><br><span class="line">    li = []</span><br><span class="line">    alphabet = [chr(i) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">97</span>, <span class="number">123</span>)]</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> alphabet:</span><br><span class="line">        count = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> ch <span class="keyword">in</span> lis:</span><br><span class="line">            <span class="keyword">if</span> ch == c:</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">        li.append(float(count) / len(lis))</span><br><span class="line">    <span class="keyword">return</span> li</span><br><span class="line"><span class="comment"># 根据密钥长度分组密文</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">textToList</span><span class="params">(text, length)</span>:</span></span><br><span class="line">    text = get_trim_text(text)</span><br><span class="line">    textMatrix = []</span><br><span class="line">    row = []</span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> text:</span><br><span class="line">        row.append(ch)</span><br><span class="line">        index += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> index % length == <span class="number">0</span>:</span><br><span class="line">            textMatrix.append(row)</span><br><span class="line">            row = []</span><br><span class="line">    textMatrix.append(row)</span><br><span class="line">    <span class="keyword">return</span> textMatrix</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取密钥</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getKey</span><span class="params">(text, length)</span>:</span></span><br><span class="line">    text = get_trim_text(text)</span><br><span class="line">    key = []  <span class="comment"># 存密钥</span></span><br><span class="line">    alphaRate = [<span class="number">0.08167</span>, <span class="number">0.01492</span>, <span class="number">0.02782</span>, <span class="number">0.04253</span>, <span class="number">0.12705</span>, <span class="number">0.02228</span>, <span class="number">0.02015</span>, <span class="number">0.06094</span>,</span><br><span class="line">                 <span class="number">0.06996</span>, <span class="number">0.00153</span>, <span class="number">0.00772</span>, <span class="number">0.04025</span>, <span class="number">0.02406</span>, <span class="number">0.06749</span>, <span class="number">0.07507</span>, <span class="number">0.01929</span>,</span><br><span class="line">                 <span class="number">0.0009</span>, <span class="number">0.05987</span>, <span class="number">0.06327</span>, <span class="number">0.09056</span>, <span class="number">0.02758</span>, <span class="number">0.00978</span>, <span class="number">0.02360</span>, <span class="number">0.0015</span>, <span class="number">0.01974</span>, <span class="number">0.00074</span>]<span class="comment">#��Ȼ���ɣ�������</span></span><br><span class="line">    matrix = textToList(text, length)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(length):</span><br><span class="line">        w = [row[i] <span class="keyword">for</span> row <span class="keyword">in</span> matrix <span class="keyword">if</span> len(row) &gt; i]  <span class="comment"># 获取密文</span></span><br><span class="line">        li = countList(w)</span><br><span class="line">        powLi = []  <span class="comment"># 算乘积</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">26</span>):</span><br><span class="line">            Sum = <span class="number">0.0</span></span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">26</span>):</span><br><span class="line">                Sum += alphaRate[k] * li[k]</span><br><span class="line">            powLi.append(Sum)</span><br><span class="line">            li = li[<span class="number">1</span>:] + li[:<span class="number">1</span>]  <span class="comment"># 循环移位</span></span><br><span class="line">        Abs = <span class="number">100</span></span><br><span class="line">        ch = <span class="string">''</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(len(powLi)):</span><br><span class="line">            <span class="keyword">if</span> abs(powLi[j] - <span class="number">0.065546</span>) &lt; Abs:  <span class="comment"># 找出最接近IC的项</span></span><br><span class="line">                Abs = abs(powLi[j] - <span class="number">0.065546</span>)  <span class="comment"># 保存最接近的距离，作为下次比较的基准</span></span><br><span class="line">                ch = chr(j + <span class="number">97</span>)</span><br><span class="line">        key.append(ch)</span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line">key_lengths = []</span><br><span class="line">c = input(<span class="string">"输入密文："</span>)</span><br><span class="line">key_lengths = get_key_length(c)</span><br><span class="line">print(key_lengths)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(key_lengths)):</span><br><span class="line">    key = getKey(c,key_lengths[i])</span><br><span class="line">    print(<span class="string">"明文%s, 密钥长度是 %d, 密钥是 %s"</span> \</span><br><span class="line">          % (VigenereDecrypto (c , key), key_lengths[i], key))</span><br></pre></td></tr></table></figure>

<h3 id="程序运行截图-1"><a href="#程序运行截图-1" class="headerlink" title="程序运行截图"></a><span style='font-size:14.0pt;font-family:黑体'>程序运行截图</span></h3><p><span lang=EN-US><img src="/2020/02/20/pws/image007.jpg" class=""></span></p>
<p><span lang=EN-US><img src="/2020/02/20/pws/image008.jpg" class=""></span></p>
<h1 id="分组密码"><a href="#分组密码" class="headerlink" title="分组密码"></a><a name="_Toc534469238"><span style='font-size:16.0pt;font-family:黑体'>分组密码</span></a></h1><h2 id="DES过程分析"><a href="#DES过程分析" class="headerlink" title="DES过程分析"></a><span style='font-size:14.0pt;font-family:黑体'>DES过程分析</span></h2><h3 id="所需参数"><a href="#所需参数" class="headerlink" title="所需参数"></a><span style='font-size:14.0pt;font-family:黑体'>所需参数</span></h3><p><span lang=EN-US>key:8</span><span>个字节共<span lang=EN-US>64</span>位密钥</span></p>
<p><span lang=EN-US>data</span><span>：<span lang=EN-US>8</span>个字节共<span lang=EN-US>64</span>位需要被加密的明文</span></p>
<h3 id="初始置换"><a href="#初始置换" class="headerlink" title="初始置换"></a><span style='font-size:14.0pt;font-family:黑体'>初始置换</span></h3><p><span lang=EN-US>DES</span><span>算法使用<span lang=EN-US>64</span>位的密钥<span lang=EN-US>key</span>将<span lang=EN-US>64</span>位的明文输入块变为<span lang=EN-US>64</span>位的密文输出块，并把输出块分为<span
lang=EN-US>L0</span>、<span lang=EN-US>R0</span>两部分，每部分均为<span lang=EN-US>32</span>位。初始置换规则如下：</span></p>
<div style='border:none;border-left:solid #6CE26C 2.25pt;padding:0cm 0cm 0cm 0cm;
background:white;margin-left:18.0pt;margin-right:0cm'>

<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>58,50,42,34,26,18,10,2,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>60,52,44,36,28,20,12,4,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>62,54,46,38,30,22,14,6,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>64,56,48,40,32,24,16,8,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>57,49,41,33,25,17,&nbsp;9,1,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>59,51,43,35,27,19,11,3,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>61,53,45,37,29,21,13,5,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>8.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>63,55,47,39,31,23,15,7,&nbsp;&nbsp;</span></p>
</div>

<h3 id="加密-迭代处理函数（F函数）"><a href="#加密-迭代处理函数（F函数）" class="headerlink" title="加密-迭代处理函数（F函数）"></a><span style='font-size:14.0pt;font-family:黑体'>加密-迭代处理函数（F函数）</span></h3><p><span>经过初始置换之后，进行<span lang=EN-US>16</span>轮完全相同的运算，在运算过程中数据与密钥结合。</span></p>
<p><span>函数<span lang=EN-US>F</span>的输出经过一个异或运算，和左半部分结合形成新的右半部分，原来的右半部分成为新的左半部分。</span></p>
<p><span lang=EN-US>F</span><span>函数：</span><span>是由四步运算构成：密钥置换；拓展置换；<span lang=EN-US>S</span>盒代替；<span lang=EN-US>P</span>置换；</span></p>
<p><span>密钥置换—子密钥生成：</span><span lang=EN-US>DES</span><span>算法由<span lang=EN-US>64</span>位密钥产生<span lang=EN-US>16</span>轮的<span lang=EN-US>48</span>位子密钥。在每一轮的迭代过程中，使用不同的子密钥。</span></p>
<p><span lang=EN-US>1. </span><span>把密钥的奇偶校验位忽略不参与计算，即每个字符的第<span lang=EN-US>8</span>位，将<span lang=EN-US>6</span>位密钥降为<span lang=EN-US>56</span>位，让后根据选择置换<span lang=EN-US>PC-1</span>将<span lang=EN-US>56</span>位分成<span lang=EN-US>2</span>块<span lang=EN-US>C0</span>和<span lang=EN-US>D0</span>各<span lang=EN-US>28</span>位。</span></p>
<p><span lang=EN-US>2. </span><span>将<span lang=EN-US>C0</span>和<span lang=EN-US>D0</span>进行循环左移变化（美伦循环作业的位数由轮数决定），变换后产生<span lang=EN-US>C1</span>和<span lang=EN-US>D1</span>，然后<span lang=EN-US>C1</span>和<span lang=EN-US>D1</span>合并，并通过选择置换<span lang=EN-US>pc-2</span>生成子密钥<span lang=EN-US>k1</span>（<span lang=EN-US>48</span>位）</span></p>
<p><span lang=EN-US>3. C1</span><span>和<span lang=EN-US>D1</span>再次经过循环左移变换，生成<span lang=EN-US>C2</span>和<span lang=EN-US>D2</span>，然后合并<span lang=EN-US>C2</span>，<span lang=EN-US>D2</span>，通过选择置换<span lang=EN-US>pc</span>—<span lang=EN-US>2</span>生成密钥<span lang=EN-US>K2</span>（<span lang=EN-US>48</span>位）</span></p>
<p><span lang=EN-US>4. </span><span>以此类推，得到<span lang=EN-US>K16</span>。最后一轮的左右两部分不交换，而是直接合并在一起<span lang=EN-US>R16L16</span>，作为逆置换的输入块。</span></p>
<p><span>密钥置换选择<span lang=EN-US>1 &nbsp;PC</span>—<span lang=EN-US>1</span></span></p>
<p><span lang=EN-US>64</span><span>位秘钥降至<span lang=EN-US>56</span>位秘钥不是说将每个字节的第八位删除，而是通过缩小选择换位表<span lang=EN-US>1</span>（置换选择表<span lang=EN-US>1</span>）的变换变成<span lang=EN-US>56</span>位。</span></p>
<div style='border:none;border-left:solid #6CE26C 2.25pt;padding:0cm 0cm 0cm 0cm;
background:white;margin-left:18.0pt;margin-right:0cm'>

<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>57,49,41,33,25,17,9,1,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>58,50,42,34,26,18,10,2,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>59,51,43,35,27,19,11,3,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>60,52,44,36,63,55,47,39,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>31,23,15,7,62,54,46,38,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>30,22,14,6,61,53,45,37,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>29,21,13,5,28,20,12,4&nbsp;&nbsp;</span></p>
</div>

<img src="/2020/02/20/pws/image009.jpg" class=""><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<p></span><span>再将<span lang=EN-US>56</span>位秘钥分成<span lang=EN-US>C0</span>和<span lang=EN-US>D0,</span></span><span lang=EN-US> </span><span>根据轮数，将<span lang=EN-US>Cn</span>和<span lang=EN-US>Dn</span>分别循环左移<span lang=EN-US>1</span>位或<span lang=EN-US>2</span>位<span lang=EN-US>.</span></span></p>
<p><span>扩展置换<span lang=EN-US>E(E</span>位选择表<span lang=EN-US>)</span></span></p>
<p><span>通过扩展置换<span lang=EN-US>E</span>，数据的右半部分<span lang=EN-US>Rn</span>从<span lang=EN-US>32</span>位扩展到<span lang=EN-US>48</span>位。扩展置换改变了位的次序，重复了某些位。扩展置换的目的：<span lang=EN-US>a</span>、产生与秘钥相同长度的数据以进行异或运算，<span lang=EN-US>R0</span>是<span lang=EN-US>32</span>位，子秘钥是<span lang=EN-US>48</span>位，所以<span lang=EN-US>R0</span>要先进行扩展置换之后与子秘钥进行异或运算；<span
lang=EN-US>b</span>、提供更长的结果，使得在替代运算时能够进行压缩。扩展置换<span lang=EN-US>E</span>规则如下：</span></p>
<p><span
lang=EN-US><img src="/2020/02/20/pws/image010.jpg" class=""></span></p>
<p><span>S-盒代替<span lang=EN-US>(</span>功能表<span lang=EN-US>S</span>盒<span lang=EN-US>)</span></span></p>
<p><span lang=EN-US>Rn</span><span>扩展置换之后与子秘钥<span lang=EN-US>Kn</span>异或以后的结果作为输入块进行<span
lang=EN-US>S</span>盒代替运算功能是把<span lang=EN-US>48</span>位数据变为<span lang=EN-US>32</span>位数据代替运算由<span
lang=EN-US>8</span>个不同的代替盒<span lang=EN-US>(S</span>盒<span lang=EN-US>)</span>完成。每个<span
lang=EN-US>S-</span>盒有<span lang=EN-US>6</span>位输入，<span lang=EN-US>4</span>位输出。所以<span
lang=EN-US>48</span>位的输入块被分成<span lang=EN-US>8</span>个<span lang=EN-US>6</span>位的分组，每一个分组对应一个<span
lang=EN-US>S-</span>盒代替操作。经过<span lang=EN-US>S-</span>盒代替，形成<span lang=EN-US>8</span>个<span
lang=EN-US>4</span>位分组结果。注意：每一个<span lang=EN-US>S-</span>盒的输入数据是<span
lang=EN-US>6</span>位，输出数据是<span lang=EN-US>4</span>位，但是每个<span lang=EN-US>S-</span>盒自身是<span
lang=EN-US>64</span>位！！每个<span lang=EN-US>S-</span>和是<span lang=EN-US>4</span>行<span
lang=EN-US>16</span>列的格式，因为二进制<span lang=EN-US>4</span>位是<span lang=EN-US>0~15</span>。<br><span lang=EN-US>8</span>个<span lang=EN-US>S-</span>盒的值如下：</span></p>
<div style='border:none;border-left:solid #6CE26C 2.25pt;padding:0cm 0cm 0cm 0cm;
background:white;margin-left:18.0pt;margin-right:0cm'>

<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:#008200'>&nbsp;&nbsp;&nbsp;//&nbsp;S1</span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;14,&nbsp;4,&nbsp;&nbsp;13,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,&nbsp;&nbsp;2,&nbsp;15,&nbsp;11,&nbsp;&nbsp;8,&nbsp;&nbsp;3,&nbsp;10,&nbsp;&nbsp;6,&nbsp;12,&nbsp;&nbsp;5,&nbsp;&nbsp;9,&nbsp;&nbsp;0,&nbsp;&nbsp;7,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;0,&nbsp;15,&nbsp;&nbsp;7,&nbsp;&nbsp;4,&nbsp;14,&nbsp;&nbsp;2,&nbsp;13,&nbsp;&nbsp;1,&nbsp;10,&nbsp;&nbsp;6,&nbsp;12,&nbsp;11,&nbsp;&nbsp;9,&nbsp;&nbsp;5,&nbsp;&nbsp;3,&nbsp;&nbsp;8,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;4,&nbsp;&nbsp;1,&nbsp;14,&nbsp;&nbsp;8,&nbsp;13,&nbsp;&nbsp;6,&nbsp;&nbsp;2,&nbsp;11,&nbsp;15,&nbsp;12,&nbsp;&nbsp;9,&nbsp;&nbsp;7,&nbsp;&nbsp;3,&nbsp;10,&nbsp;&nbsp;5,&nbsp;&nbsp;0,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;15,&nbsp;12,&nbsp;&nbsp;8,&nbsp;&nbsp;2,&nbsp;&nbsp;4,&nbsp;&nbsp;9,&nbsp;&nbsp;1,&nbsp;&nbsp;7,&nbsp;&nbsp;5,&nbsp;11,&nbsp;&nbsp;3,&nbsp;14,&nbsp;10,&nbsp;&nbsp;0,&nbsp;&nbsp;6,&nbsp;13,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;</span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#008200'>//&nbsp;S2</span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;15,&nbsp;&nbsp;1,&nbsp;&nbsp;8,&nbsp;14,&nbsp;&nbsp;6,&nbsp;11,&nbsp;&nbsp;3,&nbsp;&nbsp;4,&nbsp;&nbsp;9,&nbsp;&nbsp;7,&nbsp;&nbsp;2,&nbsp;13,&nbsp;12,&nbsp;&nbsp;0,&nbsp;&nbsp;5,&nbsp;10,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>8.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;3,&nbsp;13,&nbsp;&nbsp;4,&nbsp;&nbsp;7,&nbsp;15,&nbsp;&nbsp;2,&nbsp;&nbsp;8,&nbsp;14,&nbsp;12,&nbsp;&nbsp;0,&nbsp;&nbsp;1,&nbsp;10,&nbsp;&nbsp;6,&nbsp;&nbsp;9,&nbsp;11,&nbsp;&nbsp;5,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>9.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;0,&nbsp;14,&nbsp;&nbsp;7,&nbsp;11,&nbsp;10,&nbsp;&nbsp;4,&nbsp;13,&nbsp;&nbsp;1,&nbsp;&nbsp;5,&nbsp;&nbsp;8,&nbsp;12,&nbsp;&nbsp;6,&nbsp;&nbsp;9,&nbsp;&nbsp;3,&nbsp;&nbsp;2,&nbsp;15,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>10.<span style='font:7.0pt "Times New Roman"'> </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;13,&nbsp;&nbsp;8,&nbsp;10,&nbsp;&nbsp;1,&nbsp;&nbsp;3,&nbsp;15,&nbsp;&nbsp;4,&nbsp;&nbsp;2,&nbsp;11,&nbsp;&nbsp;6,&nbsp;&nbsp;7,&nbsp;12,&nbsp;&nbsp;0,&nbsp;&nbsp;5,&nbsp;14,&nbsp;&nbsp;9,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>11.<span
style='font:7.0pt "Times New Roman"'> </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;</span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#008200'>//&nbsp;S3</span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>12.<span style='font:7.0pt "Times New Roman"'> </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;10,&nbsp;&nbsp;0,&nbsp;&nbsp;9,&nbsp;14,&nbsp;&nbsp;6,&nbsp;&nbsp;3,&nbsp;15,&nbsp;&nbsp;5,&nbsp;&nbsp;1,&nbsp;13,&nbsp;12,&nbsp;&nbsp;7,&nbsp;11,&nbsp;&nbsp;4,&nbsp;&nbsp;2,&nbsp;&nbsp;8,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>13.<span
style='font:7.0pt "Times New Roman"'> </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;13,&nbsp;&nbsp;7,&nbsp;&nbsp;0,&nbsp;&nbsp;9,&nbsp;&nbsp;3,&nbsp;&nbsp;4,&nbsp;&nbsp;6,&nbsp;10,&nbsp;&nbsp;2,&nbsp;&nbsp;8,&nbsp;&nbsp;5,&nbsp;14,&nbsp;12,&nbsp;11,&nbsp;15,&nbsp;&nbsp;1,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>14.<span style='font:7.0pt "Times New Roman"'> </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;13,&nbsp;&nbsp;6,&nbsp;&nbsp;4,&nbsp;&nbsp;9,&nbsp;&nbsp;8,&nbsp;15,&nbsp;&nbsp;3,&nbsp;&nbsp;0,&nbsp;11,&nbsp;&nbsp;1,&nbsp;&nbsp;2,&nbsp;12,&nbsp;&nbsp;5,&nbsp;10,&nbsp;14,&nbsp;&nbsp;7,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>15.<span
style='font:7.0pt "Times New Roman"'> </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;1,&nbsp;10,&nbsp;13,&nbsp;&nbsp;0,&nbsp;&nbsp;6,&nbsp;&nbsp;9,&nbsp;&nbsp;8,&nbsp;&nbsp;7,&nbsp;&nbsp;4,&nbsp;15,&nbsp;14,&nbsp;&nbsp;3,&nbsp;11,&nbsp;&nbsp;5,&nbsp;&nbsp;2,&nbsp;12,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>16.<span style='font:7.0pt "Times New Roman"'> </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;</span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#008200'>//&nbsp;S4</span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>17.<span
style='font:7.0pt "Times New Roman"'> </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;7,&nbsp;13,&nbsp;14,&nbsp;&nbsp;3,&nbsp;&nbsp;0,&nbsp;&nbsp;6,&nbsp;&nbsp;9,&nbsp;10,&nbsp;&nbsp;1,&nbsp;&nbsp;2,&nbsp;&nbsp;8,&nbsp;&nbsp;5,&nbsp;11,&nbsp;12,&nbsp;&nbsp;4,&nbsp;15,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>18.<span style='font:7.0pt "Times New Roman"'> </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;13,&nbsp;&nbsp;8,&nbsp;11,&nbsp;&nbsp;5,&nbsp;&nbsp;6,&nbsp;15,&nbsp;&nbsp;0,&nbsp;&nbsp;3,&nbsp;&nbsp;4,&nbsp;&nbsp;7,&nbsp;&nbsp;2,&nbsp;12,&nbsp;&nbsp;1,&nbsp;10,&nbsp;14,&nbsp;&nbsp;9,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>19.<span
style='font:7.0pt "Times New Roman"'> </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;10,&nbsp;&nbsp;6,&nbsp;&nbsp;9,&nbsp;&nbsp;0,&nbsp;12,&nbsp;11,&nbsp;&nbsp;7,&nbsp;13,&nbsp;15,&nbsp;&nbsp;1,&nbsp;&nbsp;3,&nbsp;14,&nbsp;&nbsp;5,&nbsp;&nbsp;2,&nbsp;&nbsp;8,&nbsp;&nbsp;4,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>20.<span style='font:7.0pt "Times New Roman"'> </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;3,&nbsp;15,&nbsp;&nbsp;0,&nbsp;&nbsp;6,&nbsp;10,&nbsp;&nbsp;1,&nbsp;13,&nbsp;&nbsp;8,&nbsp;&nbsp;9,&nbsp;&nbsp;4,&nbsp;&nbsp;5,&nbsp;11,&nbsp;12,&nbsp;&nbsp;7,&nbsp;&nbsp;2,&nbsp;14,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>21.<span
style='font:7.0pt "Times New Roman"'> </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;</span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#008200'>//&nbsp;S5</span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>22.<span style='font:7.0pt "Times New Roman"'> </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;2,&nbsp;12,&nbsp;&nbsp;4,&nbsp;&nbsp;1,&nbsp;&nbsp;7,&nbsp;10,&nbsp;11,&nbsp;&nbsp;6,&nbsp;&nbsp;8,&nbsp;&nbsp;5,&nbsp;&nbsp;3,&nbsp;15,&nbsp;13,&nbsp;&nbsp;0,&nbsp;14,&nbsp;&nbsp;9,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>23.<span
style='font:7.0pt "Times New Roman"'> </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;14,&nbsp;11,&nbsp;&nbsp;2,&nbsp;12,&nbsp;&nbsp;4,&nbsp;&nbsp;7,&nbsp;13,&nbsp;&nbsp;1,&nbsp;&nbsp;5,&nbsp;&nbsp;0,&nbsp;15,&nbsp;10,&nbsp;&nbsp;3,&nbsp;&nbsp;9,&nbsp;&nbsp;8,&nbsp;&nbsp;6,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>24.<span style='font:7.0pt "Times New Roman"'> </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;4,&nbsp;&nbsp;2,&nbsp;&nbsp;1,&nbsp;11,&nbsp;10,&nbsp;13,&nbsp;&nbsp;7,&nbsp;&nbsp;8,&nbsp;15,&nbsp;&nbsp;9,&nbsp;12,&nbsp;&nbsp;5,&nbsp;&nbsp;6,&nbsp;&nbsp;3,&nbsp;&nbsp;0,&nbsp;14,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>25.<span
style='font:7.0pt "Times New Roman"'> </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;11,&nbsp;&nbsp;8,&nbsp;12,&nbsp;&nbsp;7,&nbsp;&nbsp;1,&nbsp;14,&nbsp;&nbsp;2,&nbsp;13,&nbsp;&nbsp;6,&nbsp;15,&nbsp;&nbsp;0,&nbsp;&nbsp;9,&nbsp;10,&nbsp;&nbsp;4,&nbsp;&nbsp;5,&nbsp;&nbsp;3,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>26.<span style='font:7.0pt "Times New Roman"'> </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;</span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#008200'>//&nbsp;S6</span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>27.<span
style='font:7.0pt "Times New Roman"'> </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;12,&nbsp;&nbsp;1,&nbsp;10,&nbsp;15,&nbsp;&nbsp;9,&nbsp;&nbsp;2,&nbsp;&nbsp;6,&nbsp;&nbsp;8,&nbsp;&nbsp;0,&nbsp;13,&nbsp;&nbsp;3,&nbsp;&nbsp;4,&nbsp;14,&nbsp;&nbsp;7,&nbsp;&nbsp;5,&nbsp;11,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>28.<span style='font:7.0pt "Times New Roman"'> </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;10,&nbsp;15,&nbsp;&nbsp;4,&nbsp;&nbsp;2,&nbsp;&nbsp;7,&nbsp;12,&nbsp;&nbsp;9,&nbsp;&nbsp;5,&nbsp;&nbsp;6,&nbsp;&nbsp;1,&nbsp;13,&nbsp;14,&nbsp;&nbsp;0,&nbsp;11,&nbsp;&nbsp;3,&nbsp;&nbsp;8,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>29.<span
style='font:7.0pt "Times New Roman"'> </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;9,&nbsp;14,&nbsp;15,&nbsp;&nbsp;5,&nbsp;&nbsp;2,&nbsp;&nbsp;8,&nbsp;12,&nbsp;&nbsp;3,&nbsp;&nbsp;7,&nbsp;&nbsp;0,&nbsp;&nbsp;4,&nbsp;10,&nbsp;&nbsp;1,&nbsp;13,&nbsp;11,&nbsp;&nbsp;6,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>30.<span style='font:7.0pt "Times New Roman"'> </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;4,&nbsp;&nbsp;3,&nbsp;&nbsp;2,&nbsp;12,&nbsp;&nbsp;9,&nbsp;&nbsp;5,&nbsp;15,&nbsp;10,&nbsp;11,&nbsp;14,&nbsp;&nbsp;1,&nbsp;&nbsp;7,&nbsp;&nbsp;6,&nbsp;&nbsp;0,&nbsp;&nbsp;8,&nbsp;13,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>31.<span
style='font:7.0pt "Times New Roman"'> </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;</span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#008200'>//&nbsp;S7</span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>32.<span style='font:7.0pt "Times New Roman"'> </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;4,&nbsp;11,&nbsp;&nbsp;2,&nbsp;14,&nbsp;15,&nbsp;&nbsp;0,&nbsp;&nbsp;8,&nbsp;13,&nbsp;&nbsp;3,&nbsp;12,&nbsp;&nbsp;9,&nbsp;&nbsp;7,&nbsp;&nbsp;5,&nbsp;10,&nbsp;&nbsp;6,&nbsp;&nbsp;1,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>33.<span
style='font:7.0pt "Times New Roman"'> </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;13,&nbsp;&nbsp;0,&nbsp;11,&nbsp;&nbsp;7,&nbsp;&nbsp;4,&nbsp;&nbsp;9,&nbsp;&nbsp;1,&nbsp;10,&nbsp;14,&nbsp;&nbsp;3,&nbsp;&nbsp;5,&nbsp;12,&nbsp;&nbsp;2,&nbsp;15,&nbsp;&nbsp;8,&nbsp;&nbsp;6,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>34.<span style='font:7.0pt "Times New Roman"'> </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;1,&nbsp;&nbsp;4,&nbsp;11,&nbsp;13,&nbsp;12,&nbsp;&nbsp;3,&nbsp;&nbsp;7,&nbsp;14,&nbsp;10,&nbsp;15,&nbsp;&nbsp;6,&nbsp;&nbsp;8,&nbsp;&nbsp;0,&nbsp;&nbsp;5,&nbsp;&nbsp;9,&nbsp;&nbsp;2,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>35.<span
style='font:7.0pt "Times New Roman"'> </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;6,&nbsp;11,&nbsp;13,&nbsp;&nbsp;8,&nbsp;&nbsp;1,&nbsp;&nbsp;4,&nbsp;10,&nbsp;&nbsp;7,&nbsp;&nbsp;9,&nbsp;&nbsp;5,&nbsp;&nbsp;0,&nbsp;15,&nbsp;14,&nbsp;&nbsp;2,&nbsp;&nbsp;3,&nbsp;12,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>36.<span style='font:7.0pt "Times New Roman"'> </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;</span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#008200'>//&nbsp;S8</span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>37.<span
style='font:7.0pt "Times New Roman"'> </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;13,&nbsp;&nbsp;2,&nbsp;&nbsp;8,&nbsp;&nbsp;4,&nbsp;&nbsp;6,&nbsp;15,&nbsp;11,&nbsp;&nbsp;1,&nbsp;10,&nbsp;&nbsp;9,&nbsp;&nbsp;3,&nbsp;14,&nbsp;&nbsp;5,&nbsp;&nbsp;0,&nbsp;12,&nbsp;&nbsp;7,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>38.<span style='font:7.0pt "Times New Roman"'> </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;1,&nbsp;15,&nbsp;13,&nbsp;&nbsp;8,&nbsp;10,&nbsp;&nbsp;3,&nbsp;&nbsp;7,&nbsp;&nbsp;4,&nbsp;12,&nbsp;&nbsp;5,&nbsp;&nbsp;6,&nbsp;11,&nbsp;&nbsp;0,&nbsp;14,&nbsp;&nbsp;9,&nbsp;&nbsp;2,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>39.<span
style='font:7.0pt "Times New Roman"'> </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;7,&nbsp;11,&nbsp;&nbsp;4,&nbsp;&nbsp;1,&nbsp;&nbsp;9,&nbsp;12,&nbsp;14,&nbsp;&nbsp;2,&nbsp;&nbsp;0,&nbsp;&nbsp;6,&nbsp;10,&nbsp;13,&nbsp;15,&nbsp;&nbsp;3,&nbsp;&nbsp;5,&nbsp;&nbsp;8,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>40.<span style='font:7.0pt "Times New Roman"'> </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>&nbsp;&nbsp;&nbsp;2,&nbsp;&nbsp;1,&nbsp;14,&nbsp;&nbsp;7,&nbsp;&nbsp;4,&nbsp;10,&nbsp;&nbsp;8,&nbsp;13,&nbsp;15,&nbsp;12,&nbsp;&nbsp;9,&nbsp;&nbsp;0,&nbsp;&nbsp;3,&nbsp;&nbsp;5,&nbsp;&nbsp;6,&nbsp;11&nbsp;&nbsp;</span></p>
</div>

<p><span>P盒置换：</span></p>
<p><span lang=EN-US>S-</span><span>盒代替运算，每一盒得到<span lang=EN-US>4</span>位，<span lang=EN-US>8</span>盒共得到<span lang=EN-US>32</span>位输出。这<span lang=EN-US>32</span>位输出作为<span lang=EN-US>P</span>盒置换的输入块。<span lang=EN-US>P</span>盒置换将每一位输入位映射到输出位。任何一位都不能被映射两次，也不能被略去。经过<span
lang=EN-US>P-</span>盒置换的结果与最初<span lang=EN-US>64</span>位分组的左半部分异或，然后左右两部分交换，开始下一轮迭代。<span lang=EN-US>P-</span>盒置换表<span lang=EN-US>(</span>表示数据的位置<span lang=EN-US>)</span>共<span lang=EN-US>32</span>位</span></p>
<div style='border:none;border-left:solid #6CE26C 2.25pt;padding:0cm 0cm 0cm 0cm;
background:white;margin-left:18.0pt;margin-right:0cm'>

<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>16,7,20,21,29,12,28,17,1,15,23,26,5,18,31,10,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>2,8,24,14,32,27,3,9,19,13,30,6,22,11,4,25,&nbsp;&nbsp;</span></p>
</div>

<h3 id="逆置换"><a href="#逆置换" class="headerlink" title="逆置换"></a><span style='font-size:14.0pt;font-family:黑体'>逆置换</span></h3><p><span>将初始置换进行<span lang=EN-US>16</span>次的迭代，即进行<span lang=EN-US>16</span>层的加密变换，这个运算过程我们暂时称为函数<span lang=EN-US>f</span>。得到<span
lang=EN-US>L16</span>和<span lang=EN-US>R16</span>，将此作为输入块，进行逆置换得到最终的密文输出块。逆置换是初始置换的逆运算。从初始置换规则中可以看到，原始数据的第<span
lang=EN-US>1</span>位置换到了第<span lang=EN-US>40</span>位，第<span lang=EN-US>2</span>位置换到了第<span
lang=EN-US>8</span>位。则逆置换就是将第<span lang=EN-US>40</span>位置换到第<span lang=EN-US>1</span>位，第<span
lang=EN-US>8</span>位置换到第<span lang=EN-US>2</span>位。以此类推，逆置换规则如下</span></p>
<div style='border:none;border-left:solid #6CE26C 2.25pt;padding:0cm 0cm 0cm 0cm;
background:white;margin-left:18.0pt;margin-right:0cm'>

<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>40,8,48,16,56,24,64,32,39,7,47,15,55,23,63,31,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>38,6,46,14,54,22,62,30,37,5,45,13,53,21,61,29,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:#5C5C5C'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='font-size:12.0pt;font-family:Consolas;color:black'>36,4,44,12,52,20,60,28,35,3,43,11,51,19,59,27,&nbsp;&nbsp;</span></p>
<p><span lang=EN-US style='font-size:12.0pt;font-family:Consolas;
color:#5C5C5C'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=EN-US style='font-size:12.0pt;font-family:Consolas;color:black'>34,2,42,10,50,18,58&nbsp;26,33,1,41,&nbsp;9,49,17,57,25,&nbsp;&nbsp;</span></p>
</div>

<h3 id="解密"><a href="#解密" class="headerlink" title="解密"></a><span style='font-size:14.0pt;font-family:黑体'>解密</span></h3><p><span>加密和解密可以使用相同的算法。加密和解密唯一不同的是秘钥的次序是相反的。就是说如果每一轮的加密秘钥分别是<span
lang=EN-US>K1</span>、<span lang=EN-US>K2</span>、<span lang=EN-US>K3…K16</span>，那么解密秘钥就是<span
lang=EN-US>K16</span>、<span lang=EN-US>K15</span>、<span lang=EN-US>K14…K1</span>。为每一轮产生秘钥的算法也是循环的。加密是秘钥循环左移，解密是秘钥循环右移。解密秘钥每次移动的位数是：<span
lang=EN-US>0</span>、<span lang=EN-US>1</span>、<span lang=EN-US>2</span>、<span
lang=EN-US>2</span>、<span lang=EN-US>2</span>、<span lang=EN-US>2</span>、<span
lang=EN-US>2</span>、<span lang=EN-US>2</span>、<span lang=EN-US>1</span>、<span
lang=EN-US>2</span>、<span lang=EN-US>2</span>、<span lang=EN-US>2</span>、<span
lang=EN-US>2</span>、<span lang=EN-US>2</span>、<span lang=EN-US>2</span>、<span
lang=EN-US>1</span>。</span></p>
<h2 id="DES安全性分析"><a href="#DES安全性分析" class="headerlink" title="DES安全性分析"></a><span style='font-size:14.0pt;font-family:黑体'>DES安全性分析</span></h2><p><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></span><span>在相信复杂函数可以通过简单函数迭代若干圈得到的原则下，利用<span
lang=EN-US>F</span>函数及对合等运算，充分利用非线性运算。至今，最有效的破解<span lang=EN-US>DES</span>算法的方法是穷举搜索法，那么<span
lang=EN-US>56</span>位长的密钥总共要测试<span lang=EN-US>256</span>次，如果每<span lang=EN-US>100</span>毫秒可以测试<span
lang=EN-US>1</span>次，那么需要<span lang=EN-US>7.2×1015</span>秒，大约是<span lang=EN-US>228,493,000</span>年。但是，仍有学者认为在可预见的将来用穷举法寻找正确密钥已趋于可行，所以若要安全保护<span
lang=EN-US>10</span>年以上的数据最好。现在多使用<span lang=EN-US>3DES</span>加密。</span></p>
<h2 id="加密-amp-解密"><a href="#加密-amp-解密" class="headerlink" title="加密&amp;解密"></a><span style='font-size:14.0pt'>加密&amp;解密</span></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="comment"># _pythonMajorVersion is used to handle Python2 and Python3 differences.</span></span><br><span class="line">_pythonMajorVersion = sys.version_info[<span class="number">0</span>]</span><br><span class="line"><span class="comment"># Modes of crypting / cyphering</span></span><br><span class="line">ECB = <span class="number">0</span></span><br><span class="line">CBC = <span class="number">1</span></span><br><span class="line"><span class="comment"># Modes of padding</span></span><br><span class="line">PAD_NORMAL = <span class="number">1</span></span><br><span class="line">PAD_PKCS5 = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># PAD_PKCS5: is a method that will unambiguously remove all padding</span></span><br><span class="line"><span class="comment">#            characters after decryption, when originally encrypted with</span></span><br><span class="line"><span class="comment">#            this padding mode.</span></span><br><span class="line"><span class="comment"># For a good description of the PKCS5 padding technique, see:</span></span><br><span class="line"><span class="comment"># http://www.faqs.org/rfcs/rfc1423.html</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The base class shared by des and triple des.</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_baseDes</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, mode=ECB, IV=None, pad=None, padmode=PAD_NORMAL)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> IV:</span><br><span class="line">            IV = self._guardAgainstUnicode(IV)</span><br><span class="line">        <span class="keyword">if</span> pad:</span><br><span class="line">            pad = self._guardAgainstUnicode(pad)</span><br><span class="line">        self.block_size = <span class="number">8</span></span><br><span class="line">        <span class="comment"># Sanity checking of arguments.</span></span><br><span class="line">        <span class="keyword">if</span> pad <span class="keyword">and</span> padmode == PAD_PKCS5:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">"Cannot use a pad character with PAD_PKCS5"</span>)</span><br><span class="line">        <span class="keyword">if</span> IV <span class="keyword">and</span> len(IV) != self.block_size:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">"Invalid Initial Value (IV), must be a multiple of "</span> + str(self.block_size) + <span class="string">" bytes"</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Set the passed in variables</span></span><br><span class="line">        self._mode = mode</span><br><span class="line">        self._iv = IV</span><br><span class="line">        self._padding = pad</span><br><span class="line">        self._padmode = padmode</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getKey</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""getKey() -&gt; bytes"""</span></span><br><span class="line">        <span class="keyword">return</span> self.__key</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setKey</span><span class="params">(self, key)</span>:</span></span><br><span class="line">        <span class="string">"""Will set the crypting key for this object."""</span></span><br><span class="line">        key = self._guardAgainstUnicode(key)</span><br><span class="line">        self.__key = key</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getMode</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""getMode() -&gt; pyDes.ECB or pyDes.CBC"""</span></span><br><span class="line">        <span class="keyword">return</span> self._mode</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setMode</span><span class="params">(self, mode)</span>:</span></span><br><span class="line">        <span class="string">"""Sets the type of crypting mode, pyDes.ECB or pyDes.CBC"""</span></span><br><span class="line">        self._mode = mode</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getPadding</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""getPadding() -&gt; bytes of length 1. Padding character."""</span></span><br><span class="line">        <span class="keyword">return</span> self._padding</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setPadding</span><span class="params">(self, pad)</span>:</span></span><br><span class="line">        <span class="string">"""setPadding() -&gt; bytes of length 1. Padding character."""</span></span><br><span class="line">        <span class="keyword">if</span> pad <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            pad = self._guardAgainstUnicode(pad)</span><br><span class="line">        self._padding = pad</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getPadMode</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""getPadMode() -&gt; pyDes.PAD_NORMAL or pyDes.PAD_PKCS5"""</span></span><br><span class="line">        <span class="keyword">return</span> self._padmode</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setPadMode</span><span class="params">(self, mode)</span>:</span></span><br><span class="line">        <span class="string">"""Sets the type of padding mode, pyDes.PAD_NORMAL or pyDes.PAD_PKCS5"""</span></span><br><span class="line">        self._padmode = mode</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getIV</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""getIV() -&gt; bytes"""</span></span><br><span class="line">        <span class="keyword">return</span> self._iv</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setIV</span><span class="params">(self, IV)</span>:</span></span><br><span class="line">        <span class="string">"""Will set the Initial Value, used in conjunction with CBC mode"""</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> IV <span class="keyword">or</span> len(IV) != self.block_size:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">"Invalid Initial Value (IV), must be a multiple of "</span> + str(self.block_size) + <span class="string">" bytes"</span>)</span><br><span class="line">        IV = self._guardAgainstUnicode(IV)</span><br><span class="line">        self._iv = IV</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_padData</span><span class="params">(self, data, pad, padmode)</span>:</span></span><br><span class="line">        <span class="comment"># Pad data depending on the mode</span></span><br><span class="line">        <span class="keyword">if</span> padmode <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="comment"># Get the default padding mode.</span></span><br><span class="line">            padmode = self.getPadMode()</span><br><span class="line">        <span class="keyword">if</span> pad <span class="keyword">and</span> padmode == PAD_PKCS5:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">"Cannot use a pad character with PAD_PKCS5"</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> padmode == PAD_NORMAL:</span><br><span class="line">            <span class="keyword">if</span> len(data) % self.block_size == <span class="number">0</span>:</span><br><span class="line">                <span class="comment"># No padding required.</span></span><br><span class="line">                <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> pad:</span><br><span class="line">                <span class="comment"># Get the default padding.</span></span><br><span class="line">                pad = self.getPadding()</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> pad:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">"Data must be a multiple of "</span> + str(</span><br><span class="line">                    self.block_size) + <span class="string">" bytes in length. Use padmode=PAD_PKCS5 or set the pad character."</span>)</span><br><span class="line">            data += (self.block_size - (len(data) % self.block_size)) * pad</span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span> padmode == PAD_PKCS5:</span><br><span class="line">            pad_len = <span class="number">8</span> - (len(data) % self.block_size)</span><br><span class="line">            <span class="keyword">if</span> _pythonMajorVersion &lt; <span class="number">3</span>:</span><br><span class="line">                data += pad_len * chr(pad_len)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                data += bytes([pad_len] * pad_len)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_unpadData</span><span class="params">(self, data, pad, padmode)</span>:</span></span><br><span class="line">        <span class="comment"># Unpad data depending on the mode.</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line">            <span class="keyword">return</span> data</span><br><span class="line">        <span class="keyword">if</span> pad <span class="keyword">and</span> padmode == PAD_PKCS5:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">"Cannot use a pad character with PAD_PKCS5"</span>)</span><br><span class="line">        <span class="keyword">if</span> padmode <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="comment"># Get the default padding mode.</span></span><br><span class="line">            padmode = self.getPadMode()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> padmode == PAD_NORMAL:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> pad:</span><br><span class="line">                <span class="comment"># Get the default padding.</span></span><br><span class="line">                pad = self.getPadding()</span><br><span class="line">            <span class="keyword">if</span> pad:</span><br><span class="line">                data = data[:-self.block_size] + \</span><br><span class="line">                       data[-self.block_size:].rstrip(pad)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span> padmode == PAD_PKCS5:</span><br><span class="line">            <span class="keyword">if</span> _pythonMajorVersion &lt; <span class="number">3</span>:</span><br><span class="line">                pad_len = ord(data[<span class="number">-1</span>])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                pad_len = data[<span class="number">-1</span>]</span><br><span class="line">            data = data[:-pad_len]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_guardAgainstUnicode</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        <span class="comment"># Only accept byte strings or ascii unicode values, otherwise</span></span><br><span class="line">        <span class="comment"># there is no way to correctly decode the data into bytes.</span></span><br><span class="line">        <span class="keyword">if</span> _pythonMajorVersion &lt; <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">if</span> isinstance(data, unicode):</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">"pyDes can only work with bytes, not Unicode strings."</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> isinstance(data, str):</span><br><span class="line">                <span class="comment"># Only accept ascii unicode values.</span></span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    <span class="keyword">return</span> data.encode(<span class="string">'ascii'</span>)</span><br><span class="line">                <span class="keyword">except</span> UnicodeEncodeError:</span><br><span class="line">                    <span class="keyword">pass</span></span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">"pyDes can only work with encoded strings, not Unicode."</span>)</span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">des</span><span class="params">(_baseDes)</span>:</span></span><br><span class="line">    <span class="string">"""DES encryption/decrytpion class</span></span><br><span class="line"><span class="string">    Supports ECB (Electronic Code Book) and CBC (Cypher Block Chaining) modes.</span></span><br><span class="line"><span class="string">    pyDes.des(key,[mode], [IV])</span></span><br><span class="line"><span class="string">    key  -&gt; Bytes containing the encryption key, must be exactly 8 bytes</span></span><br><span class="line"><span class="string">    mode -&gt; Optional argument for encryption type, can be either pyDes.ECB</span></span><br><span class="line"><span class="string">        (Electronic Code Book), pyDes.CBC (Cypher Block Chaining)</span></span><br><span class="line"><span class="string">    IV   -&gt; Optional Initial Value bytes, must be supplied if using CBC mode.</span></span><br><span class="line"><span class="string">        Must be 8 bytes in length.</span></span><br><span class="line"><span class="string">    pad  -&gt; Optional argument, set the pad character (PAD_NORMAL) to use</span></span><br><span class="line"><span class="string">        during all encrypt/decrypt operations done with this instance.</span></span><br><span class="line"><span class="string">    padmode -&gt; Optional argument, set the padding mode (PAD_NORMAL or</span></span><br><span class="line"><span class="string">        PAD_PKCS5) to use during all encrypt/decrypt operations done</span></span><br><span class="line"><span class="string">        with this instance.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Permutation and translation tables for DES</span></span><br><span class="line">    __pc1 = [<span class="number">56</span>, <span class="number">48</span>, <span class="number">40</span>, <span class="number">32</span>, <span class="number">24</span>, <span class="number">16</span>, <span class="number">8</span>,</span><br><span class="line">             <span class="number">0</span>, <span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>,</span><br><span class="line">             <span class="number">9</span>, <span class="number">1</span>, <span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>,</span><br><span class="line">             <span class="number">18</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>,</span><br><span class="line">             <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>, <span class="number">14</span>,</span><br><span class="line">             <span class="number">6</span>, <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>, <span class="number">21</span>,</span><br><span class="line">             <span class="number">13</span>, <span class="number">5</span>, <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>, <span class="number">28</span>,</span><br><span class="line">             <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">11</span>, <span class="number">3</span></span><br><span class="line">             ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># number left rotations of pc1</span></span><br><span class="line">    __left_rotations = [</span><br><span class="line">        <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># permuted choice key (table 2)</span></span><br><span class="line">    __pc2 = [</span><br><span class="line">        <span class="number">13</span>, <span class="number">16</span>, <span class="number">10</span>, <span class="number">23</span>, <span class="number">0</span>, <span class="number">4</span>,</span><br><span class="line">        <span class="number">2</span>, <span class="number">27</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">20</span>, <span class="number">9</span>,</span><br><span class="line">        <span class="number">22</span>, <span class="number">18</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">25</span>, <span class="number">7</span>,</span><br><span class="line">        <span class="number">15</span>, <span class="number">6</span>, <span class="number">26</span>, <span class="number">19</span>, <span class="number">12</span>, <span class="number">1</span>,</span><br><span class="line">        <span class="number">40</span>, <span class="number">51</span>, <span class="number">30</span>, <span class="number">36</span>, <span class="number">46</span>, <span class="number">54</span>,</span><br><span class="line">        <span class="number">29</span>, <span class="number">39</span>, <span class="number">50</span>, <span class="number">44</span>, <span class="number">32</span>, <span class="number">47</span>,</span><br><span class="line">        <span class="number">43</span>, <span class="number">48</span>, <span class="number">38</span>, <span class="number">55</span>, <span class="number">33</span>, <span class="number">52</span>,</span><br><span class="line">        <span class="number">45</span>, <span class="number">41</span>, <span class="number">49</span>, <span class="number">35</span>, <span class="number">28</span>, <span class="number">31</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># initial permutation IP</span></span><br><span class="line">    __ip = [<span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">9</span>, <span class="number">1</span>,</span><br><span class="line">            <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">11</span>, <span class="number">3</span>,</span><br><span class="line">            <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>, <span class="number">21</span>, <span class="number">13</span>, <span class="number">5</span>,</span><br><span class="line">            <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">7</span>,</span><br><span class="line">            <span class="number">56</span>, <span class="number">48</span>, <span class="number">40</span>, <span class="number">32</span>, <span class="number">24</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">0</span>,</span><br><span class="line">            <span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>, <span class="number">10</span>, <span class="number">2</span>,</span><br><span class="line">            <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span>,</span><br><span class="line">            <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">6</span></span><br><span class="line">            ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Expansion table for turning 32 bit blocks into 48 bits</span></span><br><span class="line">    __expansion_table = [</span><br><span class="line">        <span class="number">31</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>,</span><br><span class="line">        <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>,</span><br><span class="line">        <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>,</span><br><span class="line">        <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>,</span><br><span class="line">        <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>,</span><br><span class="line">        <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>,</span><br><span class="line">        <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>,</span><br><span class="line">        <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">0</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># The (in)famous S-boxes</span></span><br><span class="line">    __sbox = [</span><br><span class="line">        <span class="comment"># S1</span></span><br><span class="line">        [<span class="number">14</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">7</span>,</span><br><span class="line">         <span class="number">0</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">8</span>,</span><br><span class="line">         <span class="number">4</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">0</span>,</span><br><span class="line">         <span class="number">15</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">13</span>],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># S2</span></span><br><span class="line">        [<span class="number">15</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">10</span>,</span><br><span class="line">         <span class="number">3</span>, <span class="number">13</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">15</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">5</span>,</span><br><span class="line">         <span class="number">0</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">15</span>,</span><br><span class="line">         <span class="number">13</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">9</span>],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># S3</span></span><br><span class="line">        [<span class="number">10</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>,</span><br><span class="line">         <span class="number">13</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">1</span>,</span><br><span class="line">         <span class="number">13</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">7</span>,</span><br><span class="line">         <span class="number">1</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">12</span>],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># S4</span></span><br><span class="line">        [<span class="number">7</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">15</span>,</span><br><span class="line">         <span class="number">13</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">9</span>,</span><br><span class="line">         <span class="number">10</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>,</span><br><span class="line">         <span class="number">3</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">14</span>],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># S5</span></span><br><span class="line">        [<span class="number">2</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">9</span>,</span><br><span class="line">         <span class="number">14</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">6</span>,</span><br><span class="line">         <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">14</span>,</span><br><span class="line">         <span class="number">11</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">3</span>],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># S6</span></span><br><span class="line">        [<span class="number">12</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">11</span>,</span><br><span class="line">         <span class="number">10</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">8</span>,</span><br><span class="line">         <span class="number">9</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">6</span>,</span><br><span class="line">         <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">14</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">13</span>],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># S7</span></span><br><span class="line">        [<span class="number">4</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">3</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">1</span>,</span><br><span class="line">         <span class="number">13</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">12</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">8</span>, <span class="number">6</span>,</span><br><span class="line">         <span class="number">1</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">2</span>,</span><br><span class="line">         <span class="number">6</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">12</span>],</span><br><span class="line"></span><br><span class="line">        <span class="comment"># S8</span></span><br><span class="line">        [<span class="number">13</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">7</span>,</span><br><span class="line">         <span class="number">1</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">9</span>, <span class="number">2</span>,</span><br><span class="line">         <span class="number">7</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>,</span><br><span class="line">         <span class="number">2</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">11</span>],</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 32-bit permutation function P used on the output of the S-boxes</span></span><br><span class="line">    __p = [</span><br><span class="line">        <span class="number">15</span>, <span class="number">6</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">28</span>, <span class="number">11</span>,</span><br><span class="line">        <span class="number">27</span>, <span class="number">16</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">22</span>, <span class="number">25</span>,</span><br><span class="line">        <span class="number">4</span>, <span class="number">17</span>, <span class="number">30</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">7</span>,</span><br><span class="line">        <span class="number">23</span>, <span class="number">13</span>, <span class="number">31</span>, <span class="number">26</span>, <span class="number">2</span>, <span class="number">8</span>,</span><br><span class="line">        <span class="number">18</span>, <span class="number">12</span>, <span class="number">29</span>, <span class="number">5</span>, <span class="number">21</span>, <span class="number">10</span>,</span><br><span class="line">        <span class="number">3</span>, <span class="number">24</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># final permutation IP^-1</span></span><br><span class="line">    __fp = [</span><br><span class="line">        <span class="number">39</span>, <span class="number">7</span>, <span class="number">47</span>, <span class="number">15</span>, <span class="number">55</span>, <span class="number">23</span>, <span class="number">63</span>, <span class="number">31</span>,</span><br><span class="line">        <span class="number">38</span>, <span class="number">6</span>, <span class="number">46</span>, <span class="number">14</span>, <span class="number">54</span>, <span class="number">22</span>, <span class="number">62</span>, <span class="number">30</span>,</span><br><span class="line">        <span class="number">37</span>, <span class="number">5</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">53</span>, <span class="number">21</span>, <span class="number">61</span>, <span class="number">29</span>,</span><br><span class="line">        <span class="number">36</span>, <span class="number">4</span>, <span class="number">44</span>, <span class="number">12</span>, <span class="number">52</span>, <span class="number">20</span>, <span class="number">60</span>, <span class="number">28</span>,</span><br><span class="line">        <span class="number">35</span>, <span class="number">3</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">51</span>, <span class="number">19</span>, <span class="number">59</span>, <span class="number">27</span>,</span><br><span class="line">        <span class="number">34</span>, <span class="number">2</span>, <span class="number">42</span>, <span class="number">10</span>, <span class="number">50</span>, <span class="number">18</span>, <span class="number">58</span>, <span class="number">26</span>,</span><br><span class="line">        <span class="number">33</span>, <span class="number">1</span>, <span class="number">41</span>, <span class="number">9</span>, <span class="number">49</span>, <span class="number">17</span>, <span class="number">57</span>, <span class="number">25</span>,</span><br><span class="line">        <span class="number">32</span>, <span class="number">0</span>, <span class="number">40</span>, <span class="number">8</span>, <span class="number">48</span>, <span class="number">16</span>, <span class="number">56</span>, <span class="number">24</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Type of crypting being done</span></span><br><span class="line">    ENCRYPT = <span class="number">0x00</span></span><br><span class="line">    DECRYPT = <span class="number">0x01</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Initialisation</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, key, mode=ECB, IV=None, pad=None, padmode=PAD_NORMAL)</span>:</span></span><br><span class="line">        <span class="comment"># Sanity checking of arguments.</span></span><br><span class="line">        <span class="keyword">if</span> len(key) != <span class="number">8</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">"Invalid DES key size. Key must be exactly 8 bytes long."</span>)</span><br><span class="line">        _baseDes.__init__(self, mode, IV, pad, padmode)</span><br><span class="line">        self.key_size = <span class="number">8</span></span><br><span class="line"></span><br><span class="line">        self.L = []</span><br><span class="line">        self.R = []</span><br><span class="line">        self.Kn = [[<span class="number">0</span>] * <span class="number">48</span>] * <span class="number">16</span>  <span class="comment"># 16 48-bit keys (K1 - K16)</span></span><br><span class="line">        self.final = []</span><br><span class="line"></span><br><span class="line">        self.setKey(key)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setKey</span><span class="params">(self, key)</span>:</span></span><br><span class="line">        <span class="string">"""Will set the crypting key for this object. Must be 8 bytes."""</span></span><br><span class="line">        _baseDes.setKey(self, key)</span><br><span class="line">        self.__create_sub_keys()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__String_to_BitList</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        <span class="string">"""Turn the string data, into a list of bits (1, 0)'s"""</span></span><br><span class="line">        <span class="keyword">if</span> _pythonMajorVersion &lt; <span class="number">3</span>:</span><br><span class="line">            <span class="comment"># Turn the strings into integers. Python 3 uses a bytes</span></span><br><span class="line">            <span class="comment"># class, which already has this behaviour.</span></span><br><span class="line">            data = [ord(c) <span class="keyword">for</span> c <span class="keyword">in</span> data]</span><br><span class="line">        l = len(data) * <span class="number">8</span></span><br><span class="line">        result = [<span class="number">0</span>] * l</span><br><span class="line">        pos = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> ch <span class="keyword">in</span> data:</span><br><span class="line">            i = <span class="number">7</span></span><br><span class="line">            <span class="keyword">while</span> i &gt;= <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">if</span> ch &amp; (<span class="number">1</span> &lt;&lt; i) != <span class="number">0</span>:</span><br><span class="line">                    result[pos] = <span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    result[pos] = <span class="number">0</span></span><br><span class="line">                pos += <span class="number">1</span></span><br><span class="line">                i -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__BitList_to_String</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        <span class="string">"""Turn the list of bits -&gt; data, into a string"""</span></span><br><span class="line">        result = []</span><br><span class="line">        pos = <span class="number">0</span></span><br><span class="line">        c = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> pos &lt; len(data):</span><br><span class="line">            c += data[pos] &lt;&lt; (<span class="number">7</span> - (pos % <span class="number">8</span>))</span><br><span class="line">            <span class="keyword">if</span> (pos % <span class="number">8</span>) == <span class="number">7</span>:</span><br><span class="line">                result.append(c)</span><br><span class="line">                c = <span class="number">0</span></span><br><span class="line">            pos += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> _pythonMajorVersion &lt; <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">''</span>.join([chr(c) <span class="keyword">for</span> c <span class="keyword">in</span> result])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> bytes(result)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__permutate</span><span class="params">(self, table, block)</span>:</span></span><br><span class="line">        <span class="string">"""Permutate this block with the specified table"""</span></span><br><span class="line">        <span class="keyword">return</span> list(map(<span class="keyword">lambda</span> x: block[x], table))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Transform the secret key, so that it is ready for data processing</span></span><br><span class="line">    <span class="comment"># Create the 16 subkeys, K[1] - K[16]</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__create_sub_keys</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""Create the 16 subkeys K[1] to K[16] from the given key"""</span></span><br><span class="line">        key = self.__permutate(des.__pc1, self.__String_to_BitList(self.getKey()))</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="comment"># Split into Left and Right sections</span></span><br><span class="line">        self.L = key[:<span class="number">28</span>]</span><br><span class="line">        self.R = key[<span class="number">28</span>:]</span><br><span class="line">        <span class="keyword">while</span> i &lt; <span class="number">16</span>:</span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">            <span class="comment"># Perform circular left shifts</span></span><br><span class="line">            <span class="keyword">while</span> j &lt; des.__left_rotations[i]:</span><br><span class="line">                self.L.append(self.L[<span class="number">0</span>])</span><br><span class="line">                <span class="keyword">del</span> self.L[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">                self.R.append(self.R[<span class="number">0</span>])</span><br><span class="line">                <span class="keyword">del</span> self.R[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">                j += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># Create one of the 16 subkeys through pc2 permutation</span></span><br><span class="line">            self.Kn[i] = self.__permutate(des.__pc2, self.L + self.R)</span><br><span class="line"></span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Main part of the encryption algorithm, the number cruncher :)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__des_crypt</span><span class="params">(self, block, crypt_type)</span>:</span></span><br><span class="line">        <span class="string">"""Crypt the block of data through DES bit-manipulation"""</span></span><br><span class="line">        block = self.__permutate(des.__ip, block)</span><br><span class="line">        self.L = block[:<span class="number">32</span>]</span><br><span class="line">        self.R = block[<span class="number">32</span>:]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Encryption starts from Kn[1] through to Kn[16]</span></span><br><span class="line">        <span class="keyword">if</span> crypt_type == des.ENCRYPT:</span><br><span class="line">            iteration = <span class="number">0</span></span><br><span class="line">            iteration_adjustment = <span class="number">1</span></span><br><span class="line">        <span class="comment"># Decryption starts from Kn[16] down to Kn[1]</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            iteration = <span class="number">15</span></span><br><span class="line">            iteration_adjustment = <span class="number">-1</span></span><br><span class="line"></span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i &lt; <span class="number">16</span>:</span><br><span class="line">            <span class="comment"># Make a copy of R[i-1], this will later become L[i]</span></span><br><span class="line">            tempR = self.R[:]</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Permutate R[i - 1] to start creating R[i]</span></span><br><span class="line">            self.R = self.__permutate(des.__expansion_table, self.R)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Exclusive or R[i - 1] with K[i], create B[1] to B[8] whilst here</span></span><br><span class="line">            self.R = list(map(<span class="keyword">lambda</span> x, y: x ^ y, self.R, self.Kn[iteration]))</span><br><span class="line">            B = [self.R[:<span class="number">6</span>], self.R[<span class="number">6</span>:<span class="number">12</span>], self.R[<span class="number">12</span>:<span class="number">18</span>], self.R[<span class="number">18</span>:<span class="number">24</span>], self.R[<span class="number">24</span>:<span class="number">30</span>], self.R[<span class="number">30</span>:<span class="number">36</span>], self.R[<span class="number">36</span>:<span class="number">42</span>],</span><br><span class="line">                 self.R[<span class="number">42</span>:]]</span><br><span class="line">            <span class="comment"># Optimization: Replaced below commented code with above</span></span><br><span class="line">            <span class="comment"># j = 0</span></span><br><span class="line">            <span class="comment"># B = []</span></span><br><span class="line">            <span class="comment"># while j &lt; len(self.R):</span></span><br><span class="line">            <span class="comment">#	self.R[j] = self.R[j] ^ self.Kn[iteration][j]</span></span><br><span class="line">            <span class="comment">#	j += 1</span></span><br><span class="line">            <span class="comment">#	if j % 6 == 0:</span></span><br><span class="line">            <span class="comment">#		B.append(self.R[j-6:j])</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># Permutate B[1] to B[8] using the S-Boxes</span></span><br><span class="line">            j = <span class="number">0</span></span><br><span class="line">            Bn = [<span class="number">0</span>] * <span class="number">32</span></span><br><span class="line">            pos = <span class="number">0</span></span><br><span class="line">            <span class="keyword">while</span> j &lt; <span class="number">8</span>:</span><br><span class="line">                <span class="comment"># Work out the offsets</span></span><br><span class="line">                m = (B[j][<span class="number">0</span>] &lt;&lt; <span class="number">1</span>) + B[j][<span class="number">5</span>]</span><br><span class="line">                n = (B[j][<span class="number">1</span>] &lt;&lt; <span class="number">3</span>) + (B[j][<span class="number">2</span>] &lt;&lt; <span class="number">2</span>) + (B[j][<span class="number">3</span>] &lt;&lt; <span class="number">1</span>) + B[j][<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">                <span class="comment"># Find the permutation value</span></span><br><span class="line">                v = des.__sbox[j][(m &lt;&lt; <span class="number">4</span>) + n]</span><br><span class="line"></span><br><span class="line">                <span class="comment"># Turn value into bits, add it to result: Bn</span></span><br><span class="line">                Bn[pos] = (v &amp; <span class="number">8</span>) &gt;&gt; <span class="number">3</span></span><br><span class="line">                Bn[pos + <span class="number">1</span>] = (v &amp; <span class="number">4</span>) &gt;&gt; <span class="number">2</span></span><br><span class="line">                Bn[pos + <span class="number">2</span>] = (v &amp; <span class="number">2</span>) &gt;&gt; <span class="number">1</span></span><br><span class="line">                Bn[pos + <span class="number">3</span>] = v &amp; <span class="number">1</span></span><br><span class="line"></span><br><span class="line">                pos += <span class="number">4</span></span><br><span class="line">                j += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># Permutate the concatination of B[1] to B[8] (Bn)</span></span><br><span class="line">            self.R = self.__permutate(des.__p, Bn)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Xor with L[i - 1]</span></span><br><span class="line">            self.R = list(map(<span class="keyword">lambda</span> x, y: x ^ y, self.R, self.L))</span><br><span class="line">            <span class="comment"># Optimization: This now replaces the below commented code</span></span><br><span class="line">            <span class="comment"># j = 0</span></span><br><span class="line">            <span class="comment"># while j &lt; len(self.R):</span></span><br><span class="line">            <span class="comment">#	self.R[j] = self.R[j] ^ self.L[j]</span></span><br><span class="line">            <span class="comment">#	j += 1</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># L[i] becomes R[i - 1]</span></span><br><span class="line">            self.L = tempR</span><br><span class="line"></span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">            iteration += iteration_adjustment</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Final permutation of R[16]L[16]</span></span><br><span class="line">        self.final = self.__permutate(des.__fp, self.R + self.L)</span><br><span class="line">        <span class="keyword">return</span> self.final</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Data to be encrypted/decrypted</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">crypt</span><span class="params">(self, data, crypt_type)</span>:</span></span><br><span class="line">        <span class="string">"""Crypt the data in blocks, running it through des_crypt()"""</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># Error check the data</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">''</span></span><br><span class="line">        <span class="keyword">if</span> len(data) % self.block_size != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> crypt_type == des.DECRYPT:  <span class="comment"># Decryption must work on 8 byte blocks</span></span><br><span class="line">                <span class="keyword">raise</span> ValueError(</span><br><span class="line">                    <span class="string">"Invalid data length, data must be a multiple of "</span> + str(self.block_size) + <span class="string">" bytes\n."</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> self.getPadding():</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">"Invalid data length, data must be a multiple of "</span> + str(</span><br><span class="line">                    self.block_size) + <span class="string">" bytes\n. Try setting the optional padding character"</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                data += (self.block_size - (len(data) % self.block_size)) * self.getPadding()</span><br><span class="line">        <span class="comment"># print "Len of data: %f" % (len(data) / self.block_size)</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.getMode() == CBC:</span><br><span class="line">            <span class="keyword">if</span> self.getIV():</span><br><span class="line">                iv = self.__String_to_BitList(self.getIV())</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">"For CBC mode, you must supply the Initial Value (IV) for ciphering"</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Split the data into blocks, crypting each one seperately</span></span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        dict = &#123;&#125;</span><br><span class="line">        result = []</span><br><span class="line">        <span class="comment"># cached = 0</span></span><br><span class="line">        <span class="comment"># lines = 0</span></span><br><span class="line">        <span class="keyword">while</span> i &lt; len(data):</span><br><span class="line">            <span class="comment"># Test code for caching encryption results</span></span><br><span class="line">            <span class="comment"># lines += 1</span></span><br><span class="line">            <span class="comment"># if dict.has_key(data[i:i+8]):</span></span><br><span class="line">            <span class="comment"># print "Cached result for: %s" % data[i:i+8]</span></span><br><span class="line">            <span class="comment">#	cached += 1</span></span><br><span class="line">            <span class="comment">#	result.append(dict[data[i:i+8]])</span></span><br><span class="line">            <span class="comment">#	i += 8</span></span><br><span class="line">            <span class="comment">#	continue</span></span><br><span class="line"></span><br><span class="line">            block = self.__String_to_BitList(data[i:i + <span class="number">8</span>])</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Xor with IV if using CBC mode</span></span><br><span class="line">            <span class="keyword">if</span> self.getMode() == CBC:</span><br><span class="line">                <span class="keyword">if</span> crypt_type == des.ENCRYPT:</span><br><span class="line">                    block = list(map(<span class="keyword">lambda</span> x, y: x ^ y, block, iv))</span><br><span class="line">                <span class="comment"># j = 0</span></span><br><span class="line">                <span class="comment"># while j &lt; len(block):</span></span><br><span class="line">                <span class="comment">#	block[j] = block[j] ^ iv[j]</span></span><br><span class="line">                <span class="comment">#	j += 1</span></span><br><span class="line"></span><br><span class="line">                processed_block = self.__des_crypt(block, crypt_type)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> crypt_type == des.DECRYPT:</span><br><span class="line">                    processed_block = list(map(<span class="keyword">lambda</span> x, y: x ^ y, processed_block, iv))</span><br><span class="line">                    <span class="comment"># j = 0</span></span><br><span class="line">                    <span class="comment"># while j &lt; len(processed_block):</span></span><br><span class="line">                    <span class="comment">#	processed_block[j] = processed_block[j] ^ iv[j]</span></span><br><span class="line">                    <span class="comment">#	j += 1</span></span><br><span class="line">                    iv = block</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    iv = processed_block</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                processed_block = self.__des_crypt(block, crypt_type)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Add the resulting crypted block to our list</span></span><br><span class="line">            <span class="comment"># d = self.__BitList_to_String(processed_block)</span></span><br><span class="line">            <span class="comment"># result.append(d)</span></span><br><span class="line">            result.append(self.__BitList_to_String(processed_block))</span><br><span class="line">            <span class="comment"># dict[data[i:i+8]] = d</span></span><br><span class="line">            i += <span class="number">8</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># print "Lines: %d, cached: %d" % (lines, cached)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># Return the full crypted string</span></span><br><span class="line">        <span class="keyword">if</span> _pythonMajorVersion &lt; <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">''</span>.join(result)<span class="comment">#</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> bytes.fromhex(<span class="string">''</span>).join(result)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(self, data, pad=None, padmode=None)</span>:</span></span><br><span class="line">        <span class="string">"""encrypt(data, [pad], [padmode]) -&gt; bytes</span></span><br><span class="line"><span class="string">        data : Bytes to be encrypted</span></span><br><span class="line"><span class="string">        pad  : Optional argument for encryption padding. Must only be one byte</span></span><br><span class="line"><span class="string">        padmode : Optional argument for overriding the padding mode.</span></span><br><span class="line"><span class="string">        The data must be a multiple of 8 bytes and will be encrypted</span></span><br><span class="line"><span class="string">        with the already specified key. Data does not have to be a</span></span><br><span class="line"><span class="string">        multiple of 8 bytes if the padding character is supplied, or</span></span><br><span class="line"><span class="string">        the padmode is set to PAD_PKCS5, as bytes will then added to</span></span><br><span class="line"><span class="string">        ensure the be padded data is a multiple of 8 bytes.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        data = self._guardAgainstUnicode(data)</span><br><span class="line">        <span class="keyword">if</span> pad <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            pad = self._guardAgainstUnicode(pad)</span><br><span class="line">        data = self._padData(data, pad, padmode)</span><br><span class="line">        <span class="keyword">return</span> self.crypt(data, des.ENCRYPT)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(self, data, pad=None, padmode=None)</span>:</span></span><br><span class="line">        <span class="string">"""decrypt(data, [pad], [padmode]) -&gt; bytes</span></span><br><span class="line"><span class="string">        data : Bytes to be decrypted</span></span><br><span class="line"><span class="string">        pad  : Optional argument for decryption padding. Must only be one byte</span></span><br><span class="line"><span class="string">        padmode : Optional argument for overriding the padding mode.</span></span><br><span class="line"><span class="string">        The data must be a multiple of 8 bytes and will be decrypted</span></span><br><span class="line"><span class="string">        with the already specified key. In PAD_NORMAL mode, if the</span></span><br><span class="line"><span class="string">        optional padding character is supplied, then the un-encrypted</span></span><br><span class="line"><span class="string">        data will have the padding characters removed from the end of</span></span><br><span class="line"><span class="string">        the bytes. This pad removal only occurs on the last 8 bytes of</span></span><br><span class="line"><span class="string">        the data (last data block). In PAD_PKCS5 mode, the special</span></span><br><span class="line"><span class="string">        padding end markers will be removed from the data after decrypting.</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        data = self._guardAgainstUnicode(data)</span><br><span class="line">        <span class="keyword">if</span> pad <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            pad = self._guardAgainstUnicode(pad)</span><br><span class="line">        data = self.crypt(data, des.DECRYPT)</span><br><span class="line">        <span class="keyword">return</span> self._unpadData(data, pad, padmode)</span><br><span class="line"></span><br><span class="line"><span class="comment">#from pyDes import *</span></span><br><span class="line"><span class="comment"># For python2，</span></span><br><span class="line"><span class="comment">#   data = "Please encrypt my data"</span></span><br><span class="line"><span class="comment">#   k = des("DESCRYPT", CBC, "\0\0\0\0\0\0\0\0", pad=None, padmode=PAD_PKCS5)</span></span><br><span class="line"><span class="comment"># For Python3, you'll need to use bytes, i.e.:</span></span><br><span class="line"><span class="string">"""data = b"Please encrypt my data"</span></span><br><span class="line"><span class="string">k = des(b"DESCRYPT", CBC, b"\0\0\0\0\0\0\0\0", pad=None, padmode=PAD_PKCS5)</span></span><br><span class="line"><span class="string">d = k.encrypt(data)</span></span><br><span class="line"><span class="string">print("Encrypted: %r" % d)</span></span><br><span class="line"><span class="string">print("Decrypted: %r" % k.decrypt(d))</span></span><br><span class="line"><span class="string">assert k.decrypt(d, padmode=PAD_PKCS5) == data"""</span></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span>  time</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"Example of DES encryption using CBC mode\n"</span>)</span><br><span class="line">t = time()</span><br><span class="line">k = des(<span class="string">"KANBEKTR"</span>,CBC, <span class="string">"\0\0\0\0\0\0\0\0"</span>,pad=<span class="literal">None</span>, padmode=PAD_PKCS5)</span><br><span class="line">data = <span class="string">"CUMT-BXS"</span></span><br><span class="line"><span class="keyword">print</span> (<span class="string">"Key    : %r"</span> % k.getKey())</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"Data   : %r"</span> % data)</span><br><span class="line">d = k.encrypt(data)</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"Encrypt: %r"</span> % d)</span><br><span class="line">d = k.decrypt(d)</span><br><span class="line"><span class="keyword">print</span> (<span class="string">"Decrypt: %r"</span> % d)</span><br><span class="line"><span class="comment">#print ("DES time taken: %f (6 crypt operations)" % (time() - t))</span></span><br><span class="line"><span class="keyword">print</span> (<span class="string">""</span>)</span><br></pre></td></tr></table></figure>

<h3 id="程序运行截图-2"><a href="#程序运行截图-2" class="headerlink" title="程序运行截图"></a><span style='font-size:14.0pt'>程序运行截图</span></h3><p><span lang=EN-US><img src="/2020/02/20/pws/image011.jpg" class=""></span></p>
<h1 id="序列密码"><a href="#序列密码" class="headerlink" title="序列密码"></a><a name="_Toc28387027"><span style='font-size:18.0pt;font-family:黑体'>序列密码</span></a></h1><h2 id="线性移位寄存器（LFSR）"><a href="#线性移位寄存器（LFSR）" class="headerlink" title="线性移位寄存器（LFSR）"></a><a name="_Toc28387027"><span style='font-size:18.0pt;font-family:黑体'>线性移位寄存器（LFSR）</span></a></h2><p><span >线性反馈移位寄存器（<span lang=EN-US>linear feedback shift register</span>，<span lang=EN-US> LFSR</span>）是指，给定前一状态的输出，将该输出的线性函数再用作输入的移位寄存器。异或运算是最常见的单比特线性函数：对寄存器的某些位进行异或操作后作为输入，再对寄存器中的各比特进行整体移位。</span><br><span >线性反馈移位寄存器（<span lang=EN-US>LFSR</span>）是一个产生二进制位序列的机制。这个寄存器由一个初始化矢量设置的一系列信元组成，最常见的是，密钥。这个寄存器的行为被一个时钟调节。在每个定时时刻，这个寄存器信元的内容被移动到一个正确的位置，这个排外的或这个信元子集内的内容被放在最左边的信元中。输出的一个位通常来自整个更新程序。<span  lang=EN-US>LFSRs</span>的应用包括产生伪随机数字，伪噪声序列，快速数字计算器和灰数序列。<span lang=EN-US>LFSR</span>软件和硬件的执行是相同的。</span></p>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a><span style='font-size:14.0pt'>实现</span></h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">char</span> rg[<span class="number">100</span>];</span><br><span class="line"><span class="keyword">char</span> jrg[<span class="number">100</span>];</span><br><span class="line"><span class="keyword">int</span> sc[<span class="number">100</span>];</span><br><span class="line"><span class="keyword">char</span> fs[<span class="number">100</span>];</span><br><span class="line"><span class="keyword">char</span> res[<span class="number">1000000</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(rg,<span class="string">'\0'</span>,<span class="keyword">sizeof</span>(rg));<span class="comment">//100000000000001 </span></span><br><span class="line">	<span class="built_in">memset</span>(fs,<span class="string">'\0'</span>,<span class="keyword">sizeof</span>(fs));<span class="comment">//100000000000001 </span></span><br><span class="line">	<span class="comment">//memset(jrg,'\0',sizeof(jrg));</span></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%s"</span>,&amp;rg);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%s"</span>,&amp;fs);</span><br><span class="line">	<span class="keyword">int</span> l=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="built_in">strlen</span>(fs);i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(fs[i] == <span class="string">'1'</span>)&#123;</span><br><span class="line">			sc[l]=<span class="built_in">strlen</span>(fs)-i;</span><br><span class="line">			<span class="built_in">cout</span>&lt;&lt;sc[l]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">			l++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;l&lt;&lt;<span class="string">" "</span>&lt;&lt;<span class="built_in">strlen</span>(fs)&lt;&lt;<span class="string">" "</span>&lt;&lt;<span class="built_in">strlen</span>(rg)&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> t,c,time;</span><br><span class="line">	<span class="comment">//scanf("%d",&amp;t);</span></span><br><span class="line">	<span class="built_in">strcpy</span>(jrg,rg);</span><br><span class="line">	<span class="comment">//printf("%s\n",jrg);</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;;i++)&#123;</span><br><span class="line">		c=rg[sc[l<span class="number">-1</span>]<span class="number">-1</span>];</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=l<span class="number">-2</span>;j&gt;=<span class="number">0</span>;j--)&#123;</span><br><span class="line">			<span class="comment">//res[i]=fs[j-1]^fs[j];</span></span><br><span class="line">			c=<span class="keyword">char</span>(((<span class="keyword">int</span>(c))+<span class="keyword">int</span>(rg[sc[j]<span class="number">-1</span>]))%<span class="number">2</span>+<span class="string">'0'</span>);</span><br><span class="line">		&#125;	<span class="comment">//xor</span></span><br><span class="line">		res[i]=rg[<span class="built_in">strlen</span>(rg)<span class="number">-1</span>];</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="built_in">strlen</span>(rg)<span class="number">-1</span>;k&gt;<span class="number">0</span>;k--)&#123;</span><br><span class="line">			rg[k]=rg[k<span class="number">-1</span>];</span><br><span class="line">		&#125;	<span class="comment">//&gt;&gt;1</span></span><br><span class="line">		rg[<span class="number">0</span>]=c;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"%s\n"</span>,rg);</span><br><span class="line">		<span class="keyword">if</span>(!<span class="built_in">strcmp</span>(rg,jrg))&#123;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		time=i+<span class="number">2</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"周期为:%d\n"</span>,time);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%s\n"</span>,res);</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="程序运行截图-3"><a href="#程序运行截图-3" class="headerlink" title="程序运行截图"></a><a name="_Toc28387027"><span style='font-size:18.0pt;font-family:黑体'>程序运行截图</span></a></h2><p><span lang=EN-US><img src="/2020/02/20/pws/image012.jpg" class=""></span></p>
<p><span lang=EN-US><img src="/2020/02/20/pws/image013.jpg" class=""></span></p>
<p><span lang=EN-US style='font-size:14.0pt'>&nbsp;</span></p>
<h1 id="哈希函数"><a href="#哈希函数" class="headerlink" title="哈希函数"></a><a name="_Toc28387027"><span style='font-size:16.0pt;font-family:黑体'>哈希函数</span></a></h1><h2 id="SHA-256分析"><a href="#SHA-256分析" class="headerlink" title="SHA-256分析"></a><a name="_Toc28387027"><span style='font-size:14.0pt;font-family:黑体'>SHA-256分析</span></a></h2><h3 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a><a name="_Toc28387027"><span style='font-size:14.0pt;font-family:黑体'>初始化</span></a></h3><p><span lang=EN-US><img src="/2020/02/20/pws/image014.jpg" class=""></span></p>
<h3 id="准备消息列表"><a href="#准备消息列表" class="headerlink" title="准备消息列表"></a><a name="_Toc28387027"><span style='font-size:14.0pt;font-family:黑体'>准备消息列表</span></a></h3><p><span lang=EN-US><img src="/2020/02/20/pws/image015.jpg" class=""></span></p>
<h3 id="轮散列值初始化"><a href="#轮散列值初始化" class="headerlink" title="轮散列值初始化"></a><a name="_Toc28387027"><span style='font-size:14.0pt;font-family:黑体'>轮散列值初始化</span></a></h3><p>用每一轮的散列值的中间结果初始化8个工作变量A、B、C、D、E、F、G、H。初始定义由H0(0)-H7(7)给出。</p>
<h3 id="压缩函数"><a href="#压缩函数" class="headerlink" title="压缩函数"></a><a name="_Toc28387027"><span style='font-size:14.0pt;font-family:黑体'>压缩函数</span></a></h3><p>对于0≤t≤63,执行（即压缩函数）：<br>T1=H+∑1{256}(e)+Ch(e,f,g)+Kt{256}+Wt<br>T2=∑0{256}(a)+Maj(a,b,c)<br>H=g g=h e=d+T1 d=c<br>c=b b=a a=T1+T2</p>
<h3 id="每组的中间散列值计算方法"><a href="#每组的中间散列值计算方法" class="headerlink" title="每组的中间散列值计算方法"></a><a name="_Toc28387027"><span style='font-size:14.0pt;font-family:黑体'>每组的中间散列值计算方法</span></a></h3><p><span lang=EN-US>H<sub>0</sub><sup>(i)</sup>=a+H<sub>0</sub><sup>(i-j)</sup>,<br>H<sub>1</sub><sup>(i)</sup>=b+H<sub>1</sub><sup>(i-j)</sup>, H<sub>2</sub><sup>(i)</sup>=c+H<sub>2</sub><sup>(i-j)</sup>,<br>H<sub>3</sub><sup>(i)</sup>=d+H<sub>3</sub><sup>(i-j)</sup>, H<sub>4</sub><sup>(i)</sup>=e+H<sub>4</sub><sup>(i-j)</sup>,<br>H<sub>5</sub><sup>(i)</sup>=f+H<sub>5</sub><sup>(i-j)</sup>, H<sub>6</sub><sup>(i)</sup>=g+H<sub>6</sub><sup>(i-j)</sup>,<br>H<sub>7</sub><sup>(i)</sup>=h+H<sub>7</sub><sup>(i-j)</sup></span></p>
<p>这里<span lang=EN-US>i</span>是指消息的第<span lang=EN-US>i</span>个分组，将所有的分组处理完毕后，最后输出<span lang=EN-US>256</span>比特的<span lang=EN-US>Hash</span>值：<br><span lang=EN-US>H<sub>0</sub><sup>(N)</sup> | | H<sub>1</sub><sup>(N)</sup><br>| | H<sub>2</sub><sup>(N)</sup> | | H<sub>3</sub><sup>(N)</sup> | | H<sub>4</sub><sup>(N)</sup><br>| | H<sub>5</sub><sup>(N)</sup> H<sub>6</sub><sup>(N)</sup> | | H<sub>7</sub><sup>(N)<br></sup></span></p>
<p>算法中使用的<span lang=EN-US>6</span>个逻辑函数：</p>
<p><span lang=EN-US><img src="/2020/02/20/pws/image016.jpg" class=""></span></p>
<h2 id="SHA-256安全分析"><a href="#SHA-256安全分析" class="headerlink" title="SHA-256安全分析"></a><a name="_Toc28387027"><span style='font-size:14.0pt;font-family:黑体'>SHA-256安全分析</span></a></h2><p><span lang=EN-US>Hash</span>函数的安全性很大程度上取决于抗强碰撞的能力，即攻击者找出两个涓息<span
lang=EN-US>M</span>和<span lang=EN-US>M<sup>t</sup>M≠M<sup>t</sup></span>，使得<span
lang=EN-US>H(M)=HM<sup>t </sup>&nbsp;,</span>因此，评价一个<span lang=EN-US>Hash</span>函数的安全性，就是看攻击者在现有的条件下，是否可以找到该函数的一对碰撞。目前已有的对<span
lang=EN-US>Hash</span>函数攻击的方法包括生日攻击、彩虹表攻击、差分攻击等。</p>
<h2 id="实现-1"><a href="#实现-1" class="headerlink" title="实现"></a><a name="_Toc28387027"><span style='font-size:14.0pt;font-family:黑体'>实现</span></a></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SHA256</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line"></span><br><span class="line">        self.W = <span class="number">32</span></span><br><span class="line">        self.M = <span class="number">1</span> &lt;&lt; self.W</span><br><span class="line">        self.FF = self.M - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        self.constants = (</span><br><span class="line">            <span class="number">0x428a2f98</span>, <span class="number">0x71374491</span>, <span class="number">0xb5c0fbcf</span>, <span class="number">0xe9b5dba5</span>,</span><br><span class="line">            <span class="number">0x3956c25b</span>, <span class="number">0x59f111f1</span>, <span class="number">0x923f82a4</span>, <span class="number">0xab1c5ed5</span>,</span><br><span class="line">            <span class="number">0xd807aa98</span>, <span class="number">0x12835b01</span>, <span class="number">0x243185be</span>, <span class="number">0x550c7dc3</span>,</span><br><span class="line">            <span class="number">0x72be5d74</span>, <span class="number">0x80deb1fe</span>, <span class="number">0x9bdc06a7</span>, <span class="number">0xc19bf174</span>,</span><br><span class="line">            <span class="number">0xe49b69c1</span>, <span class="number">0xefbe4786</span>, <span class="number">0x0fc19dc6</span>, <span class="number">0x240ca1cc</span>,</span><br><span class="line">            <span class="number">0x2de92c6f</span>, <span class="number">0x4a7484aa</span>, <span class="number">0x5cb0a9dc</span>, <span class="number">0x76f988da</span>,</span><br><span class="line">            <span class="number">0x983e5152</span>, <span class="number">0xa831c66d</span>, <span class="number">0xb00327c8</span>, <span class="number">0xbf597fc7</span>,</span><br><span class="line">            <span class="number">0xc6e00bf3</span>, <span class="number">0xd5a79147</span>, <span class="number">0x06ca6351</span>, <span class="number">0x14292967</span>,</span><br><span class="line">            <span class="number">0x27b70a85</span>, <span class="number">0x2e1b2138</span>, <span class="number">0x4d2c6dfc</span>, <span class="number">0x53380d13</span>,</span><br><span class="line">            <span class="number">0x650a7354</span>, <span class="number">0x766a0abb</span>, <span class="number">0x81c2c92e</span>, <span class="number">0x92722c85</span>,</span><br><span class="line">            <span class="number">0xa2bfe8a1</span>, <span class="number">0xa81a664b</span>, <span class="number">0xc24b8b70</span>, <span class="number">0xc76c51a3</span>,</span><br><span class="line">            <span class="number">0xd192e819</span>, <span class="number">0xd6990624</span>, <span class="number">0xf40e3585</span>, <span class="number">0x106aa070</span>,</span><br><span class="line">            <span class="number">0x19a4c116</span>, <span class="number">0x1e376c08</span>, <span class="number">0x2748774c</span>, <span class="number">0x34b0bcb5</span>,</span><br><span class="line">            <span class="number">0x391c0cb3</span>, <span class="number">0x4ed8aa4a</span>, <span class="number">0x5b9cca4f</span>, <span class="number">0x682e6ff3</span>,</span><br><span class="line">            <span class="number">0x748f82ee</span>, <span class="number">0x78a5636f</span>, <span class="number">0x84c87814</span>, <span class="number">0x8cc70208</span>,</span><br><span class="line">            <span class="number">0x90befffa</span>, <span class="number">0xa4506ceb</span>, <span class="number">0xbef9a3f7</span>, <span class="number">0xc67178f2</span>)</span><br><span class="line"></span><br><span class="line">        self.compression_vals = (</span><br><span class="line">            <span class="number">0x6a09e667</span>, <span class="number">0xbb67ae85</span>, <span class="number">0x3c6ef372</span>, <span class="number">0xa54ff53a</span>,</span><br><span class="line">            <span class="number">0x510e527f</span>, <span class="number">0x9b05688c</span>, <span class="number">0x1f83d9ab</span>, <span class="number">0x5be0cd19</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">ShiftRight</span><span class="params">(self, x, b)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> ((x &gt;&gt; b) | (x &lt;&lt; (self.W - b))) &amp; self.FF</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Pad</span><span class="params">(self, W)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> bytes(W, <span class="string">"ascii"</span>) + <span class="string">b"\x80"</span> + (<span class="string">b"\x00"</span> * ((<span class="number">55</span> <span class="keyword">if</span> (len(W) % <span class="number">64</span>) &lt; <span class="number">56</span> <span class="keyword">else</span> <span class="number">119</span>) - (len(W) % <span class="number">64</span>))) + (</span><br><span class="line">            (len(W) &lt;&lt; <span class="number">3</span>).to_bytes(<span class="number">8</span>, <span class="string">"big"</span>))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">Compress</span><span class="params">(self, Wt, Kt, A, B, C, D, E, F, G, H)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> ((H + (self.ShiftRight(E, <span class="number">6</span>) ^ self.ShiftRight(E, <span class="number">11</span>) ^ self.ShiftRight(E, <span class="number">25</span>)) + (</span><br><span class="line">                    (E &amp; F) ^ (~E &amp; G)) + Wt + Kt) + (</span><br><span class="line">                            self.ShiftRight(A, <span class="number">2</span>) ^ self.ShiftRight(A, <span class="number">13</span>) ^ self.ShiftRight(A, <span class="number">22</span>)) + (</span><br><span class="line">                            (A &amp; B) ^ (A &amp; C) ^ (B &amp; C))) &amp; self.FF, A, B, C, (D + (</span><br><span class="line">                    H + (self.ShiftRight(E, <span class="number">6</span>) ^ self.ShiftRight(E, <span class="number">11</span>) ^ self.ShiftRight(E, <span class="number">25</span>)) + (</span><br><span class="line">                        (E &amp; F) ^ (~E &amp; G)) + Wt + Kt)) &amp; self.FF, E, F, G</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hash</span><span class="params">(self, message)</span>:</span></span><br><span class="line">        message = self.Pad(message)</span><br><span class="line">        digest = list(self.compression_vals)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(message), <span class="number">64</span>):</span><br><span class="line">            S = message[i: i + <span class="number">64</span>]</span><br><span class="line">            W = [int.from_bytes(S[e: e + <span class="number">4</span>], <span class="string">"big"</span>) <span class="keyword">for</span> e <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">64</span>, <span class="number">4</span>)] + ([<span class="number">0</span>] * <span class="number">48</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">16</span>, <span class="number">64</span>):</span><br><span class="line">                W[j] = (W[j - <span class="number">16</span>] + (</span><br><span class="line">                            self.ShiftRight(W[j - <span class="number">15</span>], <span class="number">7</span>) ^ self.ShiftRight(W[j - <span class="number">15</span>], <span class="number">18</span>) ^ (W[j - <span class="number">15</span>] &gt;&gt; <span class="number">3</span>)) + W[</span><br><span class="line">                            j - <span class="number">7</span>] + (self.ShiftRight(W[j - <span class="number">2</span>], <span class="number">17</span>) ^ self.ShiftRight(W[j - <span class="number">2</span>], <span class="number">19</span>) ^ (</span><br><span class="line">                            W[j - <span class="number">2</span>] &gt;&gt; <span class="number">10</span>))) &amp; self.FF</span><br><span class="line"></span><br><span class="line">            A, B, C, D, E, F, G, H = digest</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">64</span>):</span><br><span class="line">                A, B, C, D, E, F, G, H = self.Compress(W[j], self.constants[j], A, B, C, D, E, F, G, H)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">""</span>.join(format(h, <span class="string">"02x"</span>) <span class="keyword">for</span> h <span class="keyword">in</span> <span class="string">b""</span>.join(</span><br><span class="line">            d.to_bytes(<span class="number">4</span>, <span class="string">"big"</span>) <span class="keyword">for</span> d <span class="keyword">in</span> [(x + y) &amp; self.FF <span class="keyword">for</span> x, y <span class="keyword">in</span> zip(digest, (A, B, C, D, E, F, G, H))]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    encoder = SHA256()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        message = input(<span class="string">"Enter string: "</span>)</span><br><span class="line">        print(<span class="string">f"Output: <span class="subst">&#123;encoder.hash(message)&#125;</span>\n"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="程序运行截图-4"><a href="#程序运行截图-4" class="headerlink" title="程序运行截图"></a><a name="_Toc28387027"><span style='font-size:16.0pt;font-family:黑体'>程序运行截图</span></a></h2><p><span lang=EN-US><img src="/2020/02/20/pws/image017.jpg" class=""></span></p>
<h1 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a><a name="_Toc28387027"><span style='font-size:18.0pt;font-family:黑体'>RSA</span></a></h1><h2 id="基于RSA的数字签名"><a href="#基于RSA的数字签名" class="headerlink" title="基于RSA的数字签名"></a><a name="_Toc28387027"><span style='font-size:16.0pt;font-family:黑体'>基于RSA的数字签名</span></a></h2><h3 id="用RSA进行数字签名"><a href="#用RSA进行数字签名" class="headerlink" title="用RSA进行数字签名"></a><a name="_Toc28387027"><span style='font-size:14.0pt;font-family:黑体'>用RSA进行数字签名</span></a></h3><p><span >在<span lang=EN-US>RSA</span>中，被签名的消息，密钥以及最终生成的签名都是以数字形式表示的，需要实现对文本编码成数字。用<span
lang=EN-US>RSA</span>生成签名的过程可以用下面的公式来表达。</span></p>
<p><span lang=EN-US style='font-size:10.5pt;font-family:等线'><img src="/2020/02/20/pws/image019.jpg" class=""></span></p>
<p><span lang=EN-US >&nbsp;</span></p>
<p><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></span><span >这里使用的<span lang=EN-US>D</span>和<span
lang=EN-US>N</span>就是签名者的私钥。签名就是对消息的<span lang=EN-US>D</span>次方求<span
lang=EN-US>mod N</span>的结果，也就是说将消息和自己相乘<span lang=EN-US>D</span>次，然后再求<span
lang=EN-US>N</span>的模数，最后求得的数就是签名。</span></p>
<h3 id="用RSA验证签名"><a href="#用RSA验证签名" class="headerlink" title="用RSA验证签名"></a><a name="_Toc28387027"><span style='font-size:14.0pt;font-family:黑体'>用RSA验证签名</span></a></h3><p><span lang=EN-US>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></span><span lang=EN-US >RSA</span><span>的签名验证过程可用下列公式来表达：</span></p>
<p><span lang=EN-US><img src="/2020/02/20/pws/image020.jpg" class=""></span></p>
<p><span >这里所使用的<span lang=EN-US>E</span>和<span
lang=EN-US>N</span>就是签名者的公钥。接收者计算签名的<span lang=EN-US>E</span>次方并求<span
lang=EN-US>mod N</span>，得到“由签名求得的消息”，并将其发送过来的签名内容进行对比，如果两者一致，则签名验证成功，否则签名验证失败。</span></p>
<p><span lang=EN-US>RSA</span><span >签名生成和验证过程如图：</span></p>
<p><span lang=EN-US><img src="/2020/02/20/pws/image021.jpg" class=""></span></p>
<p><span lang=EN-US >A，<span lang=EN-US >B</span><span>之间进行签名</span></p>
<p><span lang=EN-US >1.</span><span>首先，<span lang=EN-US>A</span>对明文<span lang=EN-US>M</span>进行哈希加密，得到<span lang=EN-US>H</span>（<span lang=EN-US>M</span>），然后将<span lang=EN-US>H</span>（<span lang=EN-US>M</span>）<span lang=EN-US>^d mod N </span>求出签名值<span lang=EN-US>S</span>；</span></p>
<p><span lang=EN-US >2.</span><span lang=EN-US >A</span><span>将<span lang=EN-US>M</span>和<span lang=EN-US>s</span>一齐发送给&lt;spanlang=EN-US&gt;B</span>；</span></p>
<p><span lang=EN-US >3.</span><span lang=EN-US >B</span><span>收到消息后，首先将明文<span lang=EN-US>M</span>进行哈希加密。然后判断<span lang=EN-US>H</span>（<span lang=EN-US>M</span>）<span lang=EN-US>=s^e(mod n)</span>是否成立。如果成立则签名成功。</span></p>
<p><span>注：<span lang=EN-US>d</span>，<span lang=EN-US>e</span>，<span lang=EN-US>n</span>都是<span lang=EN-US>rsa</span>加密算法中的参数。</span></p>
<h2 id="实现-2"><a href="#实现-2" class="headerlink" title="实现"></a><a name="_Toc28387027"><span style='font-size:16.0pt;font-family:黑体'>实现</span></a></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a, b)</span>:</span>  <span class="comment">#欧几里得除法</span></span><br><span class="line">    <span class="keyword">if</span> a &gt; b: a, b = b, a   <span class="comment">#a先被赋值b的地址于是b再被赋值a的地址</span></span><br><span class="line">    <span class="keyword">while</span> b != <span class="number">0</span>:</span><br><span class="line">        a, b = b, a%b</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">isPrime</span><span class="params">(n)</span>:</span>     <span class="comment">#平凡除法</span></span><br><span class="line">    <span class="keyword">if</span> n &lt;= <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>, int(math.sqrt(n)) + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> n % i== <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">prime_test</span><span class="params">(n)</span>:</span>  <span class="comment">#素性检验   Miller-Rabin</span></span><br><span class="line">    q = n - <span class="number">1</span></span><br><span class="line">    k = <span class="number">0</span>           <span class="comment"># 寻找k,q 是否满足2^k*q =n - 1</span></span><br><span class="line">    <span class="keyword">while</span> q % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        k += <span class="number">1</span></span><br><span class="line">        q = q // <span class="number">2</span></span><br><span class="line">    a = random.randint(<span class="number">2</span>, n - <span class="number">2</span>)    <span class="comment"># 如果 a^q mod n= 1, n 可能是一个素数</span></span><br><span class="line">    <span class="keyword">if</span> fast_pow(a, q, n) == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span>     <span class="comment"># 如果存在j满足 a ^ ((2 ^ j) * q) mod n == n-1, n 可能是一个素数</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>, k):</span><br><span class="line">        <span class="keyword">if</span> fast_pow(a, (<span class="number">2</span> ** j) * q, n) == n - <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span>     <span class="comment"># n 不是素数</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fast_pow</span><span class="params">(b, n, m)</span>:</span>  <span class="comment">#快速幂</span></span><br><span class="line">    ret = <span class="number">1</span></span><br><span class="line">    tmp = b</span><br><span class="line">    <span class="keyword">while</span> n:</span><br><span class="line">        <span class="keyword">if</span> n &amp; <span class="number">0x1</span>:</span><br><span class="line">            ret = ret * tmp % m</span><br><span class="line">        tmp = tmp * tmp % m</span><br><span class="line">        n &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ext_gcd</span><span class="params">(a, b)</span>:</span>      <span class="comment">#s*a+t*b=1</span></span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, a</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        x, y, q = ext_gcd(b, a % b)</span><br><span class="line">        x, y = y, (x - (a // b) * y)</span><br><span class="line">        <span class="keyword">return</span> x, y, q</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_d</span><span class="params">(phi, e)</span>:</span></span><br><span class="line">    (x, y, r) = ext_gcd(phi, e)    <span class="comment"># y maybe &lt; 0, so convert it</span></span><br><span class="line">    <span class="keyword">if</span> y &lt; <span class="number">0</span>:   <span class="comment">#return y % ph_n</span></span><br><span class="line">        <span class="keyword">return</span> y + phi     <span class="comment">#直接用加法效率高一丢丢</span></span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_key</span><span class="params">(key_len)</span>:</span>  <span class="comment">#key_len要比消息长度大的多</span></span><br><span class="line">    p = random_prime(key_len // <span class="number">2</span>)</span><br><span class="line">    q = random_prime(key_len // <span class="number">2</span>)</span><br><span class="line">    print(<span class="string">"p:"</span>+str(p))</span><br><span class="line">    print(<span class="string">"q:"</span>+str(q))</span><br><span class="line">    n = p * q</span><br><span class="line">    phi = (p <span class="number">-1</span>) * (q <span class="number">-1</span>)</span><br><span class="line">    print(<span class="string">"phi:"</span>+str(phi))</span><br><span class="line">    e = <span class="number">65537</span> <span class="comment">#e取固定值</span></span><br><span class="line">    d = generate_d(phi, e)</span><br><span class="line">    <span class="keyword">return</span> (n ,e, d)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">random_prime</span><span class="params">(half_len)</span>:</span>     <span class="comment">#随机产生p、q</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        n = random.randint(<span class="number">0</span>, <span class="number">1</span> &lt;&lt; half_len)    <span class="comment">#求2^half_len之间的大数</span></span><br><span class="line">        <span class="keyword">if</span> n % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">            found = <span class="literal">True</span>        <span class="comment"># 随机性测试</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">5</span>):       <span class="comment">#5的时候错误率已经小于千分之一</span></span><br><span class="line">                <span class="keyword">if</span> prime_test(n) == <span class="literal">False</span>:</span><br><span class="line">                    found = <span class="literal">False</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> found == <span class="literal">True</span>:</span><br><span class="line">                <span class="keyword">return</span> n</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mess2long</span><span class="params">(message)</span>:</span>         <span class="comment">#字符串转HEX</span></span><br><span class="line">	<span class="keyword">return</span> int(message.encode().hex(),<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">long2mess</span><span class="params">(long_num)</span>:</span>        <span class="comment">#解密，HEX转字符串</span></span><br><span class="line">    long_mess = hex(long_num)[<span class="number">2</span>:].replace(<span class="string">"L"</span>,<span class="string">""</span>)</span><br><span class="line">    <span class="keyword">if</span> len(long_mess) % <span class="number">2</span> != <span class="number">0</span>: long_mess = <span class="string">'0'</span> + long_mess</span><br><span class="line">    <span class="keyword">return</span> long_mess    <span class="comment">#binascii.unhexlify(long2mess(plain_num)).decode()</span></span><br><span class="line"></span><br><span class="line">message =input(<span class="string">"input your message:\n"</span>)</span><br><span class="line">mess_num = mess2long(message)</span><br><span class="line">print(<span class="string">"Change form to HEX.STR:"</span>+str(mess_num))</span><br><span class="line">mess_num_length = len(str(mess_num))</span><br><span class="line">(n, e, d) = generate_key(mess_num_length*<span class="number">15</span>)</span><br><span class="line">print(<span class="string">"n:"</span>+str(n))</span><br><span class="line">print(<span class="string">"e:"</span>+str(e))</span><br><span class="line">print(<span class="string">"d:"</span>+str(d))</span><br><span class="line">cipher = fast_pow(mess_num,e, n)</span><br><span class="line">print(<span class="string">"cipher:"</span>+str(cipher))</span><br><span class="line">print(<span class="string">"d:"</span>+str(d))</span><br><span class="line">plain_num = fast_pow(cipher, d, n)</span><br><span class="line">print(<span class="string">"HEX.message is:"</span>)</span><br><span class="line">print(str(int(long2mess(plain_num),<span class="number">16</span>)))</span><br><span class="line">print(<span class="string">"message is:"</span>)</span><br><span class="line">print(binascii.unhexlify(long2mess(plain_num)).decode())</span><br></pre></td></tr></table></figure>

<h2 id="程序运行截图-5"><a href="#程序运行截图-5" class="headerlink" title="程序运行截图"></a><a name="_Toc28387027"><span style='font-size:16.0pt;font-family:黑体'>程序运行截图</span></a></h2><p><span lang=EN-US><img src="/2020/02/20/pws/image022.jpg" class=""></span></p>
<p><span lang=EN-US><img src="/2020/02/20/pws/image023.jpg" class=""></span></p>
<h1 id="综合实验"><a href="#综合实验" class="headerlink" title="综合实验"></a><a name="_Toc28387027"><span style='font-size:18.0pt;font-family:黑体'>综合实验</span></a></h1><p><span lang=EN-US style='font-family:宋体'>Alice</span>想通过公共信道给<span lang=EN-US style='font-family:宋体'>Bob</span>传输一份秘密文件（文件非常大），又知道，很多人和机构想得到这份文件。如果你是<span lang=EN-US style='font-family:宋体'>Alice</span>，你应该怎样做？请设计一个方案，并编程实现。</p>
<p>程序没编，但是思路想好了。</p>
<h2 id="具体思路："><a href="#具体思路：" class="headerlink" title="具体思路："></a><a name="_Toc28387027"><span style='font-size:16.0pt;font-family:黑体'>具体思路：</span></a></h2><p><span
lang=EN-US style='font-family:宋体'>1.</span>首先，<span lang=EN-US
style='font-family:宋体'>A</span>要发送的明文为<span lang=EN-US style='font-family:宋体'>M</span>，<span
lang=EN-US style='font-family:宋体'>A</span>选择<span lang=EN-US style='font-family:
宋体'>DES</span>加密，则先对明文进行<span lang=EN-US style='font-family:宋体'>DES</span>加密，则加密后的密文为<span
lang=EN-US style='font-family:宋体'>C</span>。</p>
<p><span
lang=EN-US style='font-family:宋体'>2.</span>为了防止有人伪造<span lang=EN-US
style='font-family:宋体'>A</span>对<span lang=EN-US style='font-family:宋体'>B</span>发送消息，则<span
lang=EN-US style='font-family:宋体'>A</span>对密文<span lang=EN-US style='font-family:
宋体'>C</span>进行基于<span lang=EN-US style='font-family:宋体'>RSA</span>的数字签名。首先确定<span
lang=EN-US style='font-family:宋体'>RSA</span>的私钥<span lang=EN-US
style='font-family:宋体'>d</span>，公钥<span lang=EN-US style='font-family:宋体'>e</span>，<span
lang=EN-US style='font-family:宋体'>n</span>；</p>
<p><span
lang=EN-US style='font-family:宋体'>3.</span>首先<span lang=EN-US style='font-family:
宋体'>A</span>对密文进行哈希函数得到<span lang=EN-US style='font-family:宋体'>H(C),</span>然后通过<span
lang=EN-US style='font-family:宋体'>RSA</span>的私钥<span lang=EN-US
style='font-family:宋体'>D</span>进行消息的“解密”，即<span lang=EN-US style='font-family:
宋体'>Si=H(Ci)^d(mod n),</span>随后<span style='font-family:宋体'> <span lang=EN-US>A</span></span>将<span
lang=EN-US style='font-family:宋体'>C</span>与<span lang=EN-US style='font-family:
宋体'>S</span>发送给<span lang=EN-US style='font-family:宋体'>B</span>。</p>
<p><span
lang=EN-US style='font-family:宋体'>4.B</span>收到<span lang=EN-US
style='font-family:宋体'>A</span>发送过来的（<span lang=EN-US style='font-family:宋体'>C,S</span>）之后，进行消息的验证。首先<span
lang=EN-US style='font-family:宋体'>B</span>先计算<span lang=EN-US style='font-family:
宋体'>C</span>对应的哈希值，并且与<span lang=EN-US style='font-family:宋体'>Si^e</span>（<span
lang=EN-US style='font-family:宋体'>mod n</span>）比较是否同余，如果相同，则说明<span lang=EN-US
style='font-family:宋体'>B</span>收到的就是来自<span lang=EN-US style='font-family:宋体'>A</span>发送的消息，发送过程中没有人进行消息的篡改和伪造。</p>
<p><span
lang=EN-US style='font-family:宋体'>5.B</span>然后应用<span lang=EN-US
style='font-family:宋体'>DES</span>的解密算法和密钥进行解密，则得到明文<span lang=EN-US
style='font-family:宋体'>M</span>。</p>
<span lang=EN-US style='font-size:10.5pt;font-family:宋体'>

</div>

<script src="/live2d-widget/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2d-widget/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":true,"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2d-widget/assets/live2d-widget-model-koharu/assets/koharu.model.json"},"display":{"superSample":2,"width":200,"height":400,"position":"right","hOffset":0,"vOffset":-20},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2}});</script><script src="/live2d-widget/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2d-widget/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":true,"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2d-widget/assets/live2d-widget-model-koharu/assets/koharu.model.json"},"display":{"superSample":2,"width":200,"height":400,"position":"right","hOffset":0,"vOffset":-20},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2}});</script></body>

</html>

    </div>

    
    
    
      
      <div>
      
         ﻿<div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------　　　　本文结束　<i class="fa fa-heart"></i>　感谢您的阅读　　　　-------------</div>
    
</div>
      
      </div>

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/StudyM/" rel="tag"># StudyM</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/02/19/buuctf/" rel="prev" title="Buuctf刷题">
      <i class="fa fa-chevron-left"></i> Buuctf刷题
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/03/09/GXZY/" rel="next" title="高校战疫CTF">
      高校战疫CTF <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#古典密码"><span class="nav-number">1.</span> <span class="nav-text">古典密码</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#凯撒密码"><span class="nav-number">1.1.</span> <span class="nav-text">凯撒密码</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#凯撒安全性分析"><span class="nav-number">1.1.1.</span> <span class="nav-text">凯撒安全性分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#加密"><span class="nav-number">1.1.2.</span> <span class="nav-text">加密</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#破解"><span class="nav-number">1.1.3.</span> <span class="nav-text">破解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#程序运行截图"><span class="nav-number">1.1.4.</span> <span class="nav-text">程序运行截图</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#维吉尼亚密码"><span class="nav-number">1.2.</span> <span class="nav-text">维吉尼亚密码</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#仿射密码的安全性分析"><span class="nav-number">1.2.1.</span> <span class="nav-text">仿射密码的安全性分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#频率分析"><span class="nav-number">1.2.2.</span> <span class="nav-text">频率分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#加密-1"><span class="nav-number">1.2.3.</span> <span class="nav-text">加密</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#破解-1"><span class="nav-number">1.2.4.</span> <span class="nav-text">破解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#程序运行截图-1"><span class="nav-number">1.2.5.</span> <span class="nav-text">程序运行截图</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#分组密码"><span class="nav-number">2.</span> <span class="nav-text">分组密码</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#DES过程分析"><span class="nav-number">2.1.</span> <span class="nav-text">DES过程分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#所需参数"><span class="nav-number">2.1.1.</span> <span class="nav-text">所需参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#初始置换"><span class="nav-number">2.1.2.</span> <span class="nav-text">初始置换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#加密-迭代处理函数（F函数）"><span class="nav-number">2.1.3.</span> <span class="nav-text">加密-迭代处理函数（F函数）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#逆置换"><span class="nav-number">2.1.4.</span> <span class="nav-text">逆置换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#解密"><span class="nav-number">2.1.5.</span> <span class="nav-text">解密</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DES安全性分析"><span class="nav-number">2.2.</span> <span class="nav-text">DES安全性分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#加密-amp-解密"><span class="nav-number">2.3.</span> <span class="nav-text">加密&amp;解密</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#程序运行截图-2"><span class="nav-number">2.3.1.</span> <span class="nav-text">程序运行截图</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#序列密码"><span class="nav-number">3.</span> <span class="nav-text">序列密码</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#线性移位寄存器（LFSR）"><span class="nav-number">3.1.</span> <span class="nav-text">线性移位寄存器（LFSR）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实现"><span class="nav-number">3.2.</span> <span class="nav-text">实现</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#程序运行截图-3"><span class="nav-number">3.3.</span> <span class="nav-text">程序运行截图</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#哈希函数"><span class="nav-number">4.</span> <span class="nav-text">哈希函数</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SHA-256分析"><span class="nav-number">4.1.</span> <span class="nav-text">SHA-256分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#初始化"><span class="nav-number">4.1.1.</span> <span class="nav-text">初始化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#准备消息列表"><span class="nav-number">4.1.2.</span> <span class="nav-text">准备消息列表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#轮散列值初始化"><span class="nav-number">4.1.3.</span> <span class="nav-text">轮散列值初始化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#压缩函数"><span class="nav-number">4.1.4.</span> <span class="nav-text">压缩函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#每组的中间散列值计算方法"><span class="nav-number">4.1.5.</span> <span class="nav-text">每组的中间散列值计算方法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SHA-256安全分析"><span class="nav-number">4.2.</span> <span class="nav-text">SHA-256安全分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实现-1"><span class="nav-number">4.3.</span> <span class="nav-text">实现</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#程序运行截图-4"><span class="nav-number">4.4.</span> <span class="nav-text">程序运行截图</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#RSA"><span class="nav-number">5.</span> <span class="nav-text">RSA</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#基于RSA的数字签名"><span class="nav-number">5.1.</span> <span class="nav-text">基于RSA的数字签名</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#用RSA进行数字签名"><span class="nav-number">5.1.1.</span> <span class="nav-text">用RSA进行数字签名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#用RSA验证签名"><span class="nav-number">5.1.2.</span> <span class="nav-text">用RSA验证签名</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实现-2"><span class="nav-number">5.2.</span> <span class="nav-text">实现</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#程序运行截图-5"><span class="nav-number">5.3.</span> <span class="nav-text">程序运行截图</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#综合实验"><span class="nav-number">6.</span> <span class="nav-text">综合实验</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#具体思路："><span class="nav-number">6.1.</span> <span class="nav-text">具体思路：</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <a href="/">
    <img class="site-author-image" itemprop="image" alt="K_Kotori"
      src="/images/avatar.gif">
    </a>
  <p class="site-author-name" itemprop="name">K_Kotori</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">16</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=110 src="//music.163.com/outchain/player?type=0&id=913908853&auto=1&height=90"></iframe>

<div id="days"></div>
<script>
function show_date_time(){
window.setTimeout("show_date_time()", 1000);
BirthDay=new Date("02/01/2020 12:00");
today=new Date();
timeold=(today.getTime()-BirthDay.getTime());
sectimeold=timeold/1000
secondsold=Math.floor(sectimeold);
msPerDay=24*60*60*1000
e_daysold=timeold/msPerDay
daysold=Math.floor(e_daysold);
e_hrsold=(e_daysold-daysold)*24;
hrsold=setzero(Math.floor(e_hrsold));
e_minsold=(e_hrsold-hrsold)*60;
minsold=setzero(Math.floor((e_hrsold-hrsold)*60));
seconds=setzero(Math.floor((e_minsold-minsold)*60));
document.getElementById('days').innerHTML="本站已运行 "+daysold+" 天 "+hrsold+" 小时 "+minsold+" 分 "+seconds+" 秒";
}
function setzero(i){
if (i<10)
{i="0" + i};
return i;
}
show_date_time();
</script>
      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        
<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共34.3k字</span>
</div>
<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">K_Kotori</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.7.0
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

<script src="/live2d-widget/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2d-widget/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":true,"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2d-widget/assets/live2d-widget-model-koharu/assets/koharu.model.json"},"display":{"superSample":2,"width":200,"height":400,"position":"right","hOffset":0,"vOffset":-20},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2}});</script></body>
</html>

<!--������ƭ-->
<script type="text/javascript" src="/js/src/crash_cheat.js"></script>